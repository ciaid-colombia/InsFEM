
subroutine shaga2(s,t,ltopo,ngaus,shaga)

!-----------------------------------------------------------------------
!
! This routine evaluates shape functions associated to Gauss points
! for 2D. The cases available so far are:
!
! BRICKS    -->   NGAUS =   1   4   9  
! SIMPLICES -->   NGAUS =   1   3   4  6  7
!
!-----------------------------------------------------------------------
  use      typre
  implicit none
  integer(ip), intent(in)  :: ngaus,ltopo
  real(rp),    intent(in)  :: s,t
  real(rp),    intent(out) :: shaga(ngaus)
  real(rp)                 :: x1,x2,x3,x4,x5,x6,Ns(6),Nt(6)
!
! Quadrilateral and hexahedral elements
!
  if(ngaus==1) then
     shaga(1)=1.0_rp
  else if(ltopo==0 .and. ngaus==4) then
     shaga(1)= .75_rp*(s-1.0_rp/sqrt(3.0_rp))*(t-1.0_rp/sqrt(3.0_rp))
     shaga(2)=-.75_rp*(s-1.0_rp/sqrt(3.0_rp))*(t+1.0_rp/sqrt(3.0_rp))
     shaga(3)=-.75_rp*(s+1.0_rp/sqrt(3.0_rp))*(t-1.0_rp/sqrt(3.0_rp))
     shaga(4)= .75_rp*(s+1.0_rp/sqrt(3.0_rp))*(t+1.0_rp/sqrt(3.0_rp))
  else if(ltopo==0 .and. ngaus==9) then
     shaga(1)= 25.0_rp/36.0_rp*(s-sqrt(0.6_rp))*(t-sqrt(0.6_rp))*s*t
     shaga(2)=-25.0_rp/18.0_rp*(s-sqrt(0.6_rp))*(t-sqrt(0.6_rp))*(t+sqrt(0.6_rp))*s
     shaga(3)= 25.0_rp/36.0_rp*(s-sqrt(0.6_rp))*(t+sqrt(0.6_rp))*s*t
     shaga(4)=-25.0_rp/18.0_rp*(s-sqrt(0.6_rp))*(s+sqrt(0.6_rp))*(t-sqrt(0.6_rp))*t
     shaga(5)= 25.0_rp/9.0_rp*(s-sqrt(0.6_rp))*(s+sqrt(0.6_rp))*(t-sqrt(0.6_rp))*(t+sqrt(0.6_rp))
     shaga(6)=-25.0_rp/18.0_rp*(s-sqrt(0.6_rp))*(s+sqrt(0.6_rp))*(t+sqrt(0.6_rp))*t
     shaga(7)= 25.0_rp/36.0_rp*(s+sqrt(0.6_rp))*(t-sqrt(0.6_rp))*s*t
     shaga(8)=-25.0_rp/18.0_rp*(s+sqrt(0.6_rp))*(t-sqrt(0.6_rp))*(t+sqrt(0.6_rp))*s
     shaga(9)= 25.0_rp/36.0_rp*(s+sqrt(0.6_rp))*(t+sqrt(0.6_rp))*s*t
!* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
!*                                                                   *
!* Shaga con lagrange, asociados a puntos de Gauss tomados de ruqope *
!*                                                                   *
!* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  else if(ltopo==0 .and. ngaus==16) then
     x1=-0.861136311594053_rp
     x2=-0.339981043584856_rp
     x3= 0.339981043584856_rp
     x4= 0.861136311594053_rp     
     Ns(1)= ((s-x2)*(s-x3)*(s-x4))/((x1-x2)*(x1-x3)*(x1-x4))
     Ns(2)= ((s-x1)*(s-x3)*(s-x4))/((x2-x1)*(x2-x3)*(x2-x4))
     Ns(3)= ((s-x1)*(s-x2)*(s-x4))/((x3-x1)*(x3-x2)*(x3-x4))     
     Ns(4)= ((s-x1)*(s-x2)*(s-x3))/((x4-x1)*(x4-x2)*(x4-x3))
     Nt(1)= ((t-x2)*(t-x3)*(t-x4))/((x1-x2)*(x1-x3)*(x1-x4))
     Nt(2)= ((t-x1)*(t-x3)*(t-x4))/((x2-x1)*(x2-x3)*(x2-x4))
     Nt(3)= ((t-x1)*(t-x2)*(t-x4))/((x3-x1)*(x3-x2)*(x3-x4))     
     Nt(4)= ((t-x1)*(t-x2)*(t-x3))/((x4-x1)*(x4-x2)*(x4-x3))
     shaga( 1) = Ns(1)*Nt(1)                
     shaga( 2) = Ns(1)*Nt(2)               
     shaga( 3) = Ns(1)*Nt(3)                
     shaga( 4) = Ns(1)*Nt(4)                
     shaga( 5) = Ns(2)*Nt(1)                
     shaga( 6) = Ns(2)*Nt(2)                
     shaga( 7) = Ns(2)*Nt(3)                  
     shaga( 8) = Ns(2)*Nt(4)                 
     shaga( 9) = Ns(3)*Nt(1)                
     shaga(10) = Ns(3)*Nt(2)                
     shaga(11) = Ns(3)*Nt(3)                
     shaga(12) = Ns(3)*Nt(4)                
     shaga(13) = Ns(4)*Nt(1)                
     shaga(14) = Ns(4)*Nt(2)
     shaga(15) = Ns(4)*Nt(3)
     shaga(16) = Ns(4)*Nt(4)
  else if(ltopo==0 .and. ngaus==25) then
     x1 = -0.906179845938664_rp
     x2 = -0.538469310105683_rp
     x3 =  0.0_rp
     x4 =  0.538469310105683_rp
     x5 =  0.906179845938664_rp     
     Ns(1)= ((s-x2)*(s-x3)*(s-x4)*(s-x5))/((x1-x2)*(x1-x3)*(x1-x4)*(x1-x5))
     Ns(2)= ((s-x1)*(s-x3)*(s-x4)*(s-x5))/((x2-x1)*(x2-x3)*(x2-x4)*(x2-x5))
     Ns(3)= ((s-x1)*(s-x2)*(s-x4)*(s-x5))/((x3-x1)*(x3-x2)*(x3-x4)*(x3-x5))     
     Ns(4)= ((s-x1)*(s-x2)*(s-x3)*(s-x5))/((x4-x1)*(x4-x2)*(x4-x3)*(x4-x5))
     Ns(5)= ((s-x1)*(s-x2)*(s-x3)*(s-x4))/((x5-x1)*(x5-x2)*(x5-x3)*(x5-x4))
     Nt(1)= ((t-x2)*(t-x3)*(t-x4)*(t-x5))/((x1-x2)*(x1-x3)*(x1-x4)*(x1-x5))
     Nt(2)= ((t-x1)*(t-x3)*(t-x4)*(t-x5))/((x2-x1)*(x2-x3)*(x2-x4)*(x2-x5))
     Nt(3)= ((t-x1)*(t-x2)*(t-x4)*(t-x5))/((x3-x1)*(x3-x2)*(x3-x4)*(x3-x5))     
     Nt(4)= ((t-x1)*(t-x2)*(t-x3)*(t-x5))/((x4-x1)*(x4-x2)*(x4-x3)*(x4-x5))
     Nt(5)= ((t-x1)*(t-x2)*(t-x3)*(t-x4))/((x5-x1)*(x5-x2)*(x5-x3)*(x5-x4))
     shaga( 1) = Ns(1)*Nt(1)                
     shaga( 2) = Ns(1)*Nt(2)               
     shaga( 3) = Ns(1)*Nt(3)                
     shaga( 4) = Ns(1)*Nt(4)                
     shaga( 5) = Ns(1)*Nt(5)                
     shaga( 6) = Ns(2)*Nt(1)                
     shaga( 7) = Ns(2)*Nt(2)                  
     shaga( 8) = Ns(2)*Nt(3)                 
     shaga( 9) = Ns(2)*Nt(4)                
     shaga(10) = Ns(2)*Nt(5)                
     shaga(11) = Ns(3)*Nt(1)                
     shaga(12) = Ns(3)*Nt(2)                
     shaga(13) = Ns(3)*Nt(3)                
     shaga(14) = Ns(3)*Nt(4)
     shaga(15) = Ns(3)*Nt(5)
     shaga(16) = Ns(4)*Nt(1)
     shaga(17) = Ns(4)*Nt(2)                
     shaga(18) = Ns(4)*Nt(3)               
     shaga(19) = Ns(4)*Nt(4)                
     shaga(20) = Ns(4)*Nt(5)                
     shaga(21) = Ns(5)*Nt(1)                
     shaga(22) = Ns(5)*Nt(2)                
     shaga(23) = Ns(5)*Nt(3)                  
     shaga(24) = Ns(5)*Nt(4)                 
     shaga(25) = Ns(5)*Nt(5)
   else if(ltopo==0 .and. ngaus==36) then
            x1 = -0.932469514203152_rp
            x2 = -0.661209386466265_rp
            x3 = -0.238619186083197_rp
            x4 =  0.238619186083197_rp
            x5 =  0.661209386466265_rp
            x6 =  0.932469514203152_rp
     Ns(1)= ((s-x2)*(s-x3)*(s-x4)*(s-x5)*(s-x6))/((x1-x2)*(x1-x3)*(x1-x4)*(x1-x5)*(x1-x6))
     Ns(2)= ((s-x1)*(s-x3)*(s-x4)*(s-x5)*(s-x6))/((x2-x1)*(x2-x3)*(x2-x4)*(x2-x5)*(x2-x6))
     Ns(3)= ((s-x1)*(s-x2)*(s-x4)*(s-x5)*(s-x6))/((x3-x1)*(x3-x2)*(x3-x4)*(x3-x5)*(x3-x6))     
     Ns(4)= ((s-x1)*(s-x2)*(s-x3)*(s-x5)*(s-x6))/((x4-x1)*(x4-x2)*(x4-x3)*(x4-x5)*(x4-x6))
     Ns(5)= ((s-x1)*(s-x2)*(s-x3)*(s-x4)*(s-x6))/((x5-x1)*(x5-x2)*(x5-x3)*(x5-x4)*(x5-x6))
     Ns(6)= ((s-x1)*(s-x2)*(s-x3)*(s-x4)*(s-x5))/((x6-x1)*(x6-x2)*(x6-x3)*(x6-x4)*(x6-x5))     
     Nt(1)= ((t-x2)*(t-x3)*(t-x4)*(t-x5)*(t-x6))/((x1-x2)*(x1-x3)*(x1-x4)*(x1-x5))*(x1-x6)
     Nt(2)= ((t-x1)*(t-x3)*(t-x4)*(t-x5)*(t-x6))/((x2-x1)*(x2-x3)*(x2-x4)*(x2-x5))*(x2-x6)
     Nt(3)= ((t-x1)*(t-x2)*(t-x4)*(t-x5)*(t-x6))/((x3-x1)*(x3-x2)*(x3-x4)*(x3-x5))*(x3-x6)     
     Nt(4)= ((t-x1)*(t-x2)*(t-x3)*(t-x5)*(t-x6))/((x4-x1)*(x4-x2)*(x4-x3)*(x4-x5))*(x4-x6)
     Nt(5)= ((t-x1)*(t-x2)*(t-x3)*(t-x4)*(t-x6))/((x5-x1)*(x5-x2)*(x5-x3)*(x5-x4))*(x5-x6)
     Nt(6)= ((t-x1)*(t-x2)*(t-x3)*(t-x4)*(t-x5))/((x6-x1)*(x6-x2)*(x6-x3)*(x6-x4))*(x6-x5)     
     shaga( 1) = Ns(1)*Nt(1)                
     shaga( 2) = Ns(1)*Nt(2)               
     shaga( 3) = Ns(1)*Nt(3)                
     shaga( 4) = Ns(1)*Nt(4)                
     shaga( 5) = Ns(1)*Nt(5)
     shaga( 6) = Ns(1)*Nt(6)
     shaga( 7) = Ns(2)*Nt(1)                
     shaga( 8) = Ns(2)*Nt(2)                  
     shaga( 9) = Ns(2)*Nt(3)                 
     shaga(10) = Ns(2)*Nt(4)                
     shaga(11) = Ns(2)*Nt(5) 
     shaga(12) = Ns(2)*Nt(6)
     shaga(13) = Ns(3)*Nt(1)                
     shaga(14) = Ns(3)*Nt(2)                
     shaga(15) = Ns(3)*Nt(3)                
     shaga(16) = Ns(3)*Nt(4)
     shaga(17) = Ns(3)*Nt(5)
     shaga(18) = Ns(3)*Nt(6)
     shaga(19) = Ns(4)*Nt(1)
     shaga(20) = Ns(4)*Nt(2)                
     shaga(21) = Ns(4)*Nt(3)               
     shaga(22) = Ns(4)*Nt(4)                
     shaga(23) = Ns(4)*Nt(5)
     shaga(24) = Ns(4)*Nt(6)
     shaga(25) = Ns(5)*Nt(1)                
     shaga(26) = Ns(5)*Nt(2)                
     shaga(27) = Ns(5)*Nt(3)                  
     shaga(28) = Ns(5)*Nt(4)                 
     shaga(29) = Ns(5)*Nt(5)
     shaga(30) = Ns(5)*Nt(6)
     shaga(31) = Ns(6)*Nt(1)                
     shaga(31) = Ns(6)*Nt(2)                
     shaga(33) = Ns(6)*Nt(3)                  
     shaga(34) = Ns(6)*Nt(4)                 
     shaga(35) = Ns(6)*Nt(5)
     shaga(36) = Ns(6)*Nt(6)   

     else if(ltopo==0 .and. ngaus==49) then
     shaga = 1.0_rp
     else if(ltopo==0 .and. ngaus==64) then
     shaga = 1.9_rp
      else if(ltopo==0 .and. ngaus==256) then
     shaga =1.0_rp

! Triangular and tetrahedral elements

!        
  else if (ltopo==1 .and. ngaus==3) then
     shaga(1)=(6.0_rp*s-1.0_rp)/3.0_rp
     shaga(2)=(6.0_rp*t-1.0_rp)/3.0_rp
     shaga(3)=((6.0_rp-6.0_rp*s-6.0_rp*t)-1.0_rp)/3.0_rp
  else if (ltopo==1 .and. ngaus==4) then
     shaga(1)=(-45.0_rp*(s+t)+225.0_rp*s*t+9.0_rp)/4.0_rp
     shaga(2)=(  15.0_rp*(s+t)- 225.0_rp*s*t + 15.0_rp)/12.0_rp
     shaga(3)=(25.0_rp*s+15.0_rp*t-75.0_rp*s*t-5.0_rp)/4.0_rp
     shaga(4)=(15.0_rp*s+25.0_rp*t-75.0_rp*s*t-5.0_rp)/4.0_rp
  else if (ltopo==1 .and. ngaus==6) then
     shaga( 1)= 0.13855958741193319_rp-1.9897337352845312_rp*s&
              + 0.16597397329013575_rp*t+3.7248334213841829_rp*s*s&
               -0.16597397329016067_rp*t*t-0.16597397328995145_rp*s*t     
     shaga( 2)= 1.8736592735116631_rp-5.4599331074843462_rp*s&
               -5.4599331074842521_rp*t+3.7248334213846128_rp*s*s&
              + 3.7248334213844752_rp*t*t+7.6156408160597406_rp*s*t     
     shaga( 3)= 0.13855958741194829_rp+0.16597397329014507_rp*s&
               -1.9897337352844979_rp*t-0.16597397329016117_rp*s*s&
              + 3.7248334213841434_rp*t*t-0.16597397329000016_rp*s*t 
     shaga( 4)=-0.63855958741203267_rp+0.40859490520073649_rp*s&        
              + 7.9963036868787016_rp*t+0.35630540869972371_rp*s*s&
               -7.9963036868786164_rp*t*t-7.9963036868794282_rp*s*t
     shaga( 5)= 0.12634072648845063_rp-1.1212057226008412_rp*s&
               -1.1212057226007612_rp*t+0.35630540870045024_rp*s*s&
              + 0.35630540870037331_rp*t*t+8.7089145042792051_rp*s*t 
     shaga( 6)=-0.63855958741200425_rp+7.9963036868788606_rp*s&
              + 0.40859490520066188_rp*t-7.9963036868787682_rp*s*s&
              + 0.35630540869978189_rp*t*t-7.9963036868795569_rp*s*t   
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
! *   Valores de Shaga recalculados y ordenados correctamente *
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
  else if (ltopo==1 .and. ngaus==7 ) then
     shaga( 1)= 2.72848410531878471d-12-2.2500000000056843_rp*s&
               -2.2500000000057980_rp*t+2.2500000000043201_rp*s*s&
              + 2.2500000000057980_rp*t*t+49.499999999991815_rp*s*t&
               -47.249999999991246_rp*(s*s*t+s*t*t)     
     shaga( 2)= 0.26639777949480958_rp-3.0297375096564565_rp*s&
               -0.96622918276031555_rp*t+4.8606850115873783_rp*s*s&
              + 0.96622918276024450_rp*t*t+9.3577592368292528_rp*s*t&
               -8.3915300540701026_rp*(s*s*t+s*t*t)   
     shaga( 3)= 0.26639777949463905_rp-0.96622918276031555_rp*s&
               -3.0297375096565986_rp*t+0.96622918275997449_rp*s*s&
              + 4.8606850115876057_rp*t*t+9.3577592368292812_rp*s*t&
               -8.3915300540701878_rp*(s*s*t+s*t*t)             
     shaga( 4)= 2.0973452814255324_rp-6.6916325135190391_rp*s&
               -6.6916325135192096_rp*t+4.8606850115874067_rp*s*s&
              + 4.8606850115877762_rp*t*t+17.146670894483890_rp*s*t&
               -8.3915300540705715_rp*(s*s*t+s*t*t)      
     shaga( 5)=-0.76639777949526433_rp+2.7797375096587302_rp*s&
              + 8.7162291827626177_rp*t-2.1106850115889415_rp*s*s&
               -8.7162291827623903_rp*t*t-32.857759236826269_rp*s*t&
              + 24.141530054067516_rp*(s*s*t+s*t*t)      
     shaga( 6)=-0.76639777949435484_rp+8.7162291827627314_rp*s&
              + 2.7797375096592987_rp*t-8.7162291827615377_rp*s*s&
               -2.1106850115897373_rp*t*t-32.857759236826212_rp*s*t&
              + 24.141530054067402_rp*(s*s*t+s*t*t)     
     shaga( 7)=-9.73452814263282562d-02+1.4416325135204033_rp*s&
              + 1.4416325135207444_rp*t-2.1106850115887426_rp*s*s&
               -2.1106850115892826_rp*t*t-19.646670894481645_rp*s*t&
              + 24.141530054067346_rp*(s*s*t+s*t*t) 
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
! *   Valores de Shaga calculados para ngaus = 12 y ngaus = 13  *
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       
  else if (ltopo==1 .and. ngaus==12 ) then             
    shaga( 1)= 0.96009276679251343_rp-17.385595084069791_rp*s&
              -17.385595083120279_rp*t+44.146144905917708_rp*s*s&
             + 44.146144899772480_rp*t*t+297.92269653122457_rp*s*t&
              -43.900152148305345_rp*s*s*s-43.900152142537991_rp*t*t*t&
              -598.29885730302431_rp*s*s*t-598.29885723911138_rp*s*t*t&
             + 596.14314402656953_rp*s*s*s*t+596.14314396101690_rp*s*t*t*t
     shaga( 2)=-0.40704241325147450_rp+6.8835214925184118_rp*s&
              + 7.4625969139742665_rp*t-14.525969323390882_rp*s*s& 
               -26.580698902733275_rp*t*t-118.51500824570758_rp*s*t&
              + 15.922711283350331_rp*s*s*s+27.977440862625372_rp*t*t*t& 
              + 155.49835365330694_rp*s*s*t+384.94730025803256_rp*s*t*t& 
               -183.34709869820762_rp*s*s*s*t-412.79604530167808_rp*s*t*t*t
     shaga( 3)=-0.40704241328057833_rp+7.4625969148855802_rp*s&
              + 6.8835214924911270_rp*t-26.580698906684120_rp*s*s& 
               -14.525969321577577_rp*t*t-118.51500825082530_rp*s*t&
              + 27.977440866438545_rp*s*s*s+15.922711281717056_rp*t*t*t&  
              + 384.94730029953661_rp*s*s*t+155.49835363438615_rp*s*t*t&  
               -412.79604534490733_rp*s*s*s*t-183.34709867947049_rp*s*t*t*t
     shaga( 4)= 2.3033819814882008_rp-13.873290303579779_rp*s&
               -13.873290303410613_rp*t+24.819820254882217_rp*s*s& 
              + 24.819820253800572_rp*t*t+78.410266241166028_rp*s*t&  
               -15.798761394482176_rp*s*s*s-15.798761393467430_rp*t*t*t&  
               -114.36565362616091_rp*s*s*t-114.36565361488533_rp*s*t*t& 
              + 89.189701280299261_rp*s*s*s*t+89.189701268725912_rp*s*t*t*t
     shaga( 5)=-0.18911145693709841_rp+1.2764026483962425_rp*s&
              + 3.6509935073445376_rp*t-2.4197985692320856_rp*s*s& 
               -13.454127537766908_rp*t*t-20.816710393285803_rp*s*t& 
              + 2.3822162130713567_rp*s*s*s+13.416545181617039_rp*t*t*t& 
              + 26.103283087649658_rp*s*s*t+60.431419230109213_rp*s*t*t& 
              -27.430782570035721_rp*s*s*s*t-61.758918712292484_rp*s*t*t*t
     shaga( 6)=-0.18911145696620224_rp+3.6509935074652731_rp*s& 
              + 1.2764026483819180_rp*t-13.454127538402304_rp*s*s& 
               -2.4197985689424968_rp*t*t-20.816710394076608_rp*s*t&  
              + 13.416545182198170_rp*s*s*s+2.3822162128108175_rp*t*t*t& 
              + 60.431419236576176_rp*s*s*t+26.103283084643522_rp*s*t*t&  
               -61.758918719031385_rp*s*s*s*t-27.430782567055644_rp*s*t*t*t
     shaga( 7)= 0.13438316795509309_rp-2.0183010133264361_rp*s& 
               -2.5439667023019865_rp*t+3.8748209067773871_rp*s*s&  
              + 9.7418064015255368_rp*t*t+35.695295320936111_rp*s*t& 
               -4.1827892167446432_rp*s*s*s-11.135768052867206_rp*t*t*t& 
               -39.888529582294353_rp*s*s*t-128.04226803648953_rp*s*t*t& 
              + 46.347682023690908_rp*s*s*s*t+154.93593591374099_rp*s*t*t*t
     shaga( 8)= 0.65732346395088825_rp-12.423724146221502_rp*s&
               -4.9396676443575416_rp*t+42.334609098793464_rp*s*s& 
              + 9.7986172204764443_rp*t*t+80.292443375058156_rp*s*t& 
               -36.002692456799011_rp*s*s*s-9.8086025300290203_rp*t*t*t& 
               -221.15191558411868_rp*s*s*t-107.68734660463224_rp*s*t*t&  
              + 207.79068014097174_rp*s*s*s*t+114.76062659758622_rp*s*t*t*t
     shaga( 9)=-1.3272901358141098_rp+10.217452853536088_rp*s&
              + 23.693577477039071_rp*t-21.550342262551908_rp*s*s&
               -56.184882187648327_rp*t*t-164.82250143984311_rp*s*t& 
              + 19.750966236007717_rp*s*s*s+41.378886017737386_rp*t*t*t& 
              + 273.23074933799961_rp*s*s*t+309.22346511730120_rp*s*t*t& 
              -254.13836215197875_rp*s*s*s*t-269.69656249410946_rp*s*t*t*t
     shaga(10)=-1.3272901359305251_rp+23.693577477477447_rp*s& 
              + 10.217452853146824_rp*t-56.184882190683084_rp*s*s&
               -21.550342259812169_rp*t*t-164.82250144048430_rp*s*t&  
              + 41.378886020566640_rp*s*s*s+19.750966233434156_rp*t*t*t& 
              + 309.22346514865291_rp*s*s*t+273.23074930939947_rp*s*t*t& 
               -269.69656252636730_rp*s*s*s*t-254.13836212273327_rp*s*t*t*t
     shaga(11)= 0.13438316799147287_rp-2.5439667026171264_rp*s& 
               -2.0183010133259813_rp*t+9.7418064029416485_rp*s*s&  
              + 3.8748209063087415_rp*t*t+35.695295323140272_rp*s*t& 
               -11.135768054219547_rp*s*s*s-4.1827892163291835_rp*t*t*t& 
               -128.04226805114706_rp*s*s*t-39.888529577345480_rp*s*t*t& 
              + 154.93593592905765_rp*s*s*s*t+46.347682018903470_rp*s*t*t*t
     shaga(12)= 0.65732346400909591_rp-4.9396676444421246_rp*s& 
               -12.423724145759479_rp*t+9.7986172216723162_rp*s*s& 
              + 42.334609096622444_rp*t*t+80.292443372706657_rp*s*t&  
               -9.8086025311201439_rp*s*s*s-36.002692454723729_rp*t*t*t& 
               -107.68734661697806_rp*s*s*t-221.15191556139780_rp*s*t*t&  
              + 114.76062660994370_rp*s*s*s*t+207.79068011736376_rp*s*t*t*t
  else if (ltopo==1 .and. ngaus==13 ) then
    shaga( 1)=-1.0274887819832657_rp+13.326999023556255_rp*s&
             + 13.326999023349344_rp*t-41.235825294737566_rp*s*s&
              -41.235825294013011_rp*t*t-114.92367838802943_rp*s*t&
             + 52.422828933428185_rp*s*s*s+52.422828932737957_rp*t*t*t&
             + 187.96774435668732_rp*s*s*t+187.96774435420315_rp*s*t*t&  
              -471.80546036530097_rp*s*s*s*t-471.80546036273819_rp*s*t*t*t&
             + 722.39408586779473_rp*s*s*t*t
     shaga( 2)= 0.72802112787030637_rp-13.913891655753105_rp*s&
               -13.913891654912732_rp*t+35.654593605098171_rp*s*s&
              + 35.654593601902889_rp*t*t+250.07040589616372_rp*s*t&
               -31.941638682312316_rp*s*s*s-31.941638679491007_rp*t*t*t&
               -506.25470878449170_rp*s*s*t-506.25470877600219_rp*s*t*t&
              + 423.28668276025246_rp*s*s*s*t+423.28668275207440_rp*s*t*t*t&
              + 182.56881934532430_rp*s*s*t*t
     shaga( 3)= 0.29740870140085462_rp-2.0047208650785251_rp*s&
               -2.4353332914106431_rp*t+2.5107557896395747_rp*s*s&
              + 13.558701722586193_rp*t*t-29.364825900504684_rp*s*t&
               -9.8457467909236929_rp*s*s*s-20.893692723627737_rp*t*t*t&
              + 232.61947312558382_rp*s*s*t-2.6239749119572480_rp*s*t*t&
               -47.200213537305039_rp*s*s*s*t+188.04323450021707_rp*s*t*t*t&
               -523.16152414980138_rp*s*s*t*t
     shaga( 4)= 0.29740870157547761_rp-2.4353332912423866_rp*s&
               -2.0047208654941642_rp*t+13.558701721976149_rp*s*s&
              + 2.5107557910869218_rp*t*t-29.364825899241623_rp*s*t&
               -20.893692723024344_rp*s*s*s-9.8457467921207353_rp*t*t*t&
               -2.6239749117340949_rp*s*s*t+232.61947312091593_rp*s*t*t&
              + 188.04323449926514_rp*s*s*s*t-47.200213533756653_rp*s*t*t*t&
               -523.16152414831777_rp*s*s*t*t
     shaga( 5)= 2.2797107806836721_rp-12.972625453565797_rp*s&
               -12.972625453410728_rp*t+21.718125349297736_rp*s*s&
              + 21.718125348718786_rp*t*t+65.859117409618989_rp*s*t& 
               -11.060630332196560_rp*s*s*s-11.060630331684933_rp*t*t*t&
               -90.380490256560563_rp*s*s*t-90.380490255045800_rp*s*t*t&
              + 33.018342815494123_rp*s*s*s*t+33.018342814044004_rp*s*t*t*t&
              + 74.816926179720596_rp*s*s*t*t
     shaga( 6)=-0.16461424984663608_rp+3.2529356526843003_rp*s&
              + 0.80861062217900326_rp*t-12.292607786856266_rp*s*s& 
               -0.95569674256876169_rp*t*t-14.993395999425957_rp*s*t& 
              + 11.613191761306265_rp*s*s*s+0.27628071706692481_rp*t*t*t&
              + 50.144850556297278_rp*s*s*t+14.639981330540763_rp*s*t*t&
               -37.991395679118256_rp*s*s*s*t-2.4865264533676950_rp*s*t*t*t&
               -31.697681387118831_rp*s*s*t*t
     shaga( 7)=-0.16461424983208417_rp+0.80861062221197244_rp*s&
              + 3.2529356526010815_rp*t-0.95569674272314131_rp*s*s& 
               -12.292607786563167_rp*t*t-14.993395999217000_rp*s*t& 
              + 0.27628071721367808_rp*s*s*s+11.613191761062239_rp*t*t*t&
              + 14.639981330752935_rp*s*s*t+50.144850555347730_rp*s*t*t&
               -2.4865264537082923_rp*s*s*s*t-37.991395678347267_rp*s*t*t*t&
               -31.697681386868204_rp*s*s*t*t
     shaga( 8)= 8.40866246289806440d-03-0.81014195791999555_rp*s&
               -0.16411349454210722_rp*t+4.3578704816276570_rp*s*s&
               -1.4561909927579109_rp*t*t+15.559728363239969_rp*s*t& 
               -3.9398635938240130_rp*s*s*s+2.8340930329370622_rp*t*t*t&
               -86.313856620564493_rp*s*s*t-5.8735027245569427_rp*s*t*t&
              + 72.428789384490912_rp*s*s*s*t-27.725857673778542_rp*s*t*t*t&
              + 94.647582892387220_rp*s*s*t*t
     shaga( 9)= 0.48729946931416634_rp-9.6793752091675742_rp*s&
               -2.3844202914551715_rp*t+33.725031272288220_rp*s*s& 
              + 2.3313845572183709_rp*t*t+48.447210643764265_rp*s*t& 
               -24.916681941227310_rp*s*s*s+0.30904266512379763_rp*t*t*t&
               -156.69351254291357_rp*s*s*t-50.406319346349051_rp*s*t*t&
              + 86.010536427100064_rp*s*s*s*t-0.56236360718256151_rp*s*t*t*t&
              + 135.39282391656010_rp*s*s*t*t
     shaga(10)= 8.40866244834614918d-03-0.16411349458485347_rp*s&
               -0.81014195776697306_rp*t-1.4561909925539993_rp*s*s&
              + 4.3578704811143325_rp*t*t+15.559728362752708_rp*s*t&
              + 2.8340930327373917_rp*s*s*s-3.9398635933935111_rp*t*t*t&
               -5.8735027246082865_rp*s*s*t-86.313856618794432_rp*s*t*t&
               -27.725857673418105_rp*s*s*s*t+72.428789383126500_rp*s*t*t*t&
              + 94.647582891815418_rp*s*s*t*t
     shaga(11)=-1.1186241466493811_rp+20.020721814234093_rp*s&
              + 6.9553551058706944_rp*t-45.739718103534699_rp*s*s&
               -12.176423856002657_rp*t*t-120.15163956625338_rp*s*t&
              + 28.059817649610135_rp*s*s*s+7.0829993034412837_rp*t*t*t&
              + 223.23517800207372_rp*s*s*t+189.93913781349045_rp*s*t*t&
               -114.29875779738948_rp*s*s*s*t-100.71701077120159_rp*s*t*t*t&
               -165.07111696880548_rp*s*s*t*t
     shaga(12)= 0.48729946932871826_rp-2.3844202915870483_rp*s&
               -9.6793752089070040_rp*t+2.3313845577458494_rp*s*s&
              + 33.725031271402258_rp*t*t+48.447210643204016_rp*s*t&
              + 0.30904266462977503_rp*s*s*s-24.916681940470426_rp*t*t*t&
               -50.406319347185985_rp*s*s*t-156.69351254008183_rp*s*t*t&
               -0.56236360601700985_rp*s*s*s*t+86.010536424773349_rp*s*t*t*t&
              + 135.39282391588259_rp*s*s*t*t
     shaga(13)=-1.1186241466202773_rp+6.9553551061935650_rp*s&
              + 20.020721813860291_rp*t-12.176423857261909_rp*s*s&
               -45.739718102140614_rp*t*t-120.15163956607466_rp*s*t&
              + 7.0829993045789355_rp*s*s*s+28.059817648387252_rp*t*t*t&
              + 189.93913781665896_rp*s*s*t+223.23517799827482_rp*s*t*t&
               -100.71701077435398_rp*s*s*s*t-114.29875779386907_rp*s*t*t*t&
               -165.07111696857837_rp*s*s*t*t

! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
! * Valores de Shaga calculados para ngaus = 15 con cuadratura  *
! * cerrada para p5 exacto                                      *
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       
    else if (ltopo==1 .and. ngaus==15 ) then             
     shaga( 1)=   1.0000000000036380_rp+(  -8.3333333334921917_rp)*s+(  -8.3333333334921917_rp)*t&
               +(  23.3333333342179685_rp)*s*s+(  23.3333333342488913_rp)*t*t+(  48.4646743398957369_rp)*s*t&
               +( -26.6666666681470019_rp)*s*s*s+( -26.6666666681967399_rp)*t*t*t+( -83.3152184149769255_rp)*s*s*t&
               +( -83.3152184151310848_rp)*s*t*t+(  10.6666666674143897_rp)*s*s*s*s+(  10.6666666674386761_rp)*t*t*t*t&
               +(  44.1838774082058023_rp)*s*s*s*t+(  67.0344214842568249_rp)*s*s*t*t+(  44.1838774082991677_rp)*s*t*t*t
     shaga( 2)=   0.0000000000000284_rp+(  -0.9999999999974740_rp)*s+(   0.0000000000008811_rp)*t&
               +(   7.3333333333189632_rp)*s*s+(  -0.0000000000051514_rp)*t*t+(   0.2807969323081281_rp)*s*t&
               +( -15.9999999999762199_rp)*s*s*s+(   0.0000000000085656_rp)*t*t*t+(   1.2364138045634334_rp)*s*s*t&
               +(  -0.2807969322706239_rp)*s*t*t+(  10.6666666666547059_rp)*s*s*s*s+(  -0.0000000000043308_rp)*t*t*t*t&
               +(  -1.5172107368690897_rp)*s*s*s*t+(  -1.5172107369162715_rp)*s*s*t*t+(  -0.0000000000342917_rp)*s*t*t*t
     shaga( 3)=   0.0000000000000568_rp+(   0.0000000000009095_rp)*s+(  -0.9999999999976126_rp)*t&
               +(  -0.0000000000048423_rp)*s*s+(   7.3333333333196151_rp)*t*t+(   0.2807969323084976_rp)*s*t&
               +(   0.0000000000081046_rp)*s*s*s+( -15.9999999999765521_rp)*t*t*t+(  -0.2807969322737502_rp)*s*s*t&
               +(   1.2364138045616002_rp)*s*t*t+(  -0.0000000000040843_rp)*s*s*s*s+(  10.6666666666549830_rp)*t*t*t*t&
               +(  -0.0000000000324771_rp)*s*s*s*t+(  -1.5172107369120971_rp)*s*s*t*t+(  -1.5172107368673551_rp)*s*t*t*t
     shaga( 4)=   0.0000000000218279_rp+(  16.0000000003747118_rp)*s+(   0.0000000002874003_rp)*t&
               +( -69.3333333354410115_rp)*s*s+(  -0.0000000015916157_rp)*t*t+( -79.7694350723932075_rp)*s*t&
               +(  96.0000000035275320_rp)*s*s*s+(   0.0000000026575435_rp)*t*t*t+( 211.2134420756940472_rp)*s*s*t&
               +( 119.6021122364136318_rp)*s*t*t+( -42.6666666684495084_rp)*s*s*s*s+(  -0.0000000013415047_rp)*t*t*t*t&
               +(-136.7773403361930775_rp)*s*s*s*t+(-149.9433508352551598_rp)*s*s*t*t+( -55.8326771634506258_rp)*s*t*t*t
     shaga( 5)=   0.0000000000036380_rp+( -12.0000000002560228_rp)*s+(  -0.0000000001236913_rp)*t&
               +(  76.0000000014252919_rp)*s*s+(   0.0000000006839400_rp)*t*t+(  34.9456552233868933_rp)*s*t&
               +(-128.0000000023889015_rp)*s*s*s+(  -0.0000000011459633_rp)*t*t*t+(-150.9456552308158734_rp)*s*s*t&
               +( -35.1521840712055109_rp)*s*t*t+(  64.0000000012041710_rp)*s*s*s*s+(   0.0000000005770744_rp)*t*t*t*t&
               +( 128.0000000071673867_rp)*s*s*s*t+(  76.2065288559824694_rp)*s*s*t*t+(  12.2065288474843783_rp)*s*t*t*t
     shaga( 6)=  -0.0000000000009095_rp+(   5.3333333333723658_rp)*s+(   0.0000000000118234_rp)*t&
               +( -37.3333333335594801_rp)*s*s+(  -0.0000000000662794_rp)*t*t+(  -6.9920947394621180_rp)*s*t&
               +(  74.6666666670428043_rp)*s*s*s+(   0.0000000001102194_rp)*t*t*t+(  24.8814210820214541_rp)*s*s*t&
               +(   6.0474315694772400_rp)*s*t*t+( -42.6666666668577079_rp)*s*s*s*s+(  -0.0000000000557918_rp)*t*t*t*t&
               +( -33.8893263425222955_rp)*s*s*s*t+(   4.3886701606570888_rp)*s*s*t*t+(  -4.3886701633013701_rp)*s*t*t*t
     shaga( 7)=   0.0000000000018190_rp+(  -0.0000000000853788_rp)*s+(  -0.0000000000313776_rp)*t&
               +(   0.0000000004719141_rp)*s*s+(   0.0000000001753051_rp)*t*t+(   8.0632420921942867_rp)*s*t&
               +(  -0.0000000007879990_rp)*s*s*s+(  -0.0000000002929710_rp)*t*t*t+( -47.8959192493797872_rp)*s*s*t&
               +(  -7.1185789229376155_rp)*s*t*t+(   0.0000000003987015_rp)*s*s*s*s+(   0.0000000001480203_rp)*t*t*t*t&
               +(  55.8326771571037881_rp)*s*s*s*t+(  17.5546806548235281_rp)*s*s*t*t+(   4.3886701639723640_rp)*s*t*t*t
     shaga( 8)=   0.0000000000004547_rp+(  -0.0000000000146656_rp)*s+(  -0.0000000000147793_rp)*t&
               +(   0.0000000000808882_rp)*s*s+(   0.0000000000837872_rp)*t*t+(  -1.2608736244689567_rp)*s*t&
               +(  -0.0000000001355609_rp)*s*s*s+(  -0.0000000001402896_rp)*t*t*t+(   1.4674024674377790_rp)*s*s*t&
               +(   1.4674024674318957_rp)*s*t*t+(   0.0000000000681117_rp)*s*s*s*s+(   0.0000000000704858_rp)*t*t*t*t&
               +( -12.2065288429870833_rp)*s*s*s*t+(  39.5869423141255865_rp)*s*s*t*t+( -12.2065288429873533_rp)*s*t*t*t
     shaga( 9)=  -0.0000000000018190_rp+(  -0.0000000000309228_rp)*s+(  -0.0000000000836735_rp)*t&
               +(   0.0000000001664375_rp)*s*s+(   0.0000000004856702_rp)*t*t+(   8.0632420922024721_rp)*s*t&
               +(  -0.0000000002787885_rp)*s*s*s+(  -0.0000000008099050_rp)*t*t*t+(  -7.1185789229073748_rp)*s*s*t&
               +( -47.8959192494714898_rp)*s*t*t+(   0.0000000001408225_rp)*s*s*s*s+(   0.0000000004104095_rp)*t*t*t*t&
               +(   4.3886701639702750_rp)*s*s*s*t+(  17.5546806548536551_rp)*s*s*t*t+(  55.8326771571770450_rp)*s*t*t*t
     shaga(10)=   0.0000000000009095_rp+(   0.0000000000113687_rp)*s+(   5.3333333333748669_rp)*t&
               +(  -0.0000000000623004_rp)*s*s+( -37.3333333335672251_rp)*t*t+(  -6.9920947394698487_rp)*s*t&
               +(   0.0000000001044782_rp)*s*s*s+(  74.6666666670587347_rp)*t*t*t+(   6.0474315694737584_rp)*s*s*t&
               +(  24.8814210820885933_rp)*s*t*t+(  -0.0000000000528626_rp)*s*s*s*s+( -42.6666666668641028_rp)*t*t*t*t&
               +(  -4.3886701633092073_rp)*s*s*s*t+(   4.3886701606180765_rp)*s*s*t*t+( -33.8893263425786131_rp)*s*t*t*t
     shaga(11)=   0.0000000000000000_rp+(  -0.0000000001164153_rp)*s+( -12.0000000002619345_rp)*t&
               +(   0.0000000006548362_rp)*s*s+(  76.0000000014715624_rp)*t*t+(  34.9456552234114497_rp)*s*t&
               +(  -0.0000000010986128_rp)*s*s*s+(-128.0000000024665496_rp)*t*t*t+( -35.1521840711213827_rp)*s*s*t&
               +(-150.9456552311207815_rp)*s*t*t+(   0.0000000005536549_rp)*s*s*s*s+(  64.0000000012423698_rp)*t*t*t*t&
               +(  12.2065288474785518_rp)*s*s*s*t+(  76.2065288561027501_rp)*s*s*t*t+( 128.0000000074010131_rp)*s*t*t*t
     shaga(12)=  -0.0000000000072760_rp+(   0.0000000002710294_rp)*s+(  16.0000000003929017_rp)*t&
               +(  -0.0000000015311343_rp)*s*s+( -69.3333333355112700_rp)*t*t+( -79.7694350724123069_rp)*s*t&
               +(   0.0000000025710278_rp)*s*s*s+(  96.0000000036416168_rp)*t*t*t+( 119.6021122361757989_rp)*s*s*t&
               +( 211.2134420760958164_rp)*s*t*t+(  -0.0000000012939552_rp)*s*s*s*s+( -42.6666666685041491_rp)*t*t*t*t&
               +( -55.8326771633475119_rp)*s*s*s*t+(-149.9433508353474735_rp)*s*s*t*t+(-136.7773403364694786_rp)*s*t*t*t
     shaga(13)=   0.0000000000145519_rp+(  -0.0000000003819878_rp)*s+(  -0.0000000004001777_rp)*t&
               +(   0.0000000021809683_rp)*s*s+(   0.0000000022519089_rp)*t*t+(  83.3411663078350102_rp)*s*t&
               +(  -0.0000000036493475_rp)*s*s*s+(  -0.0000000037653081_rp)*t*t*t+(-188.4829805611818756_rp)*s*s*t&
               +(-188.4829805615527221_rp)*s*t*t+(   0.0000000018402773_rp)*s*s*s*s+(   0.0000000019017534_rp)*t*t*t*t&
               +( 105.1418142528370367_rp)*s*s*s*t+( 210.2836285085713826_rp)*s*s*t*t+( 105.1418142530505975_rp)*s*t*t*t
     shaga(14)=  -0.0000000000036380_rp+(   0.0000000002305569_rp)*s+(   0.0000000001127773_rp)*t&
               +(  -0.0000000013075123_rp)*s*s+(  -0.0000000006393748_rp)*t*t+( -21.8006479476589448_rp)*s*t&
               +(   0.0000000021808262_rp)*s*s*s+(   0.0000000010663825_rp)*t*t*t+( 126.9424621956307533_rp)*s*s*t&
               +(  21.8006479517496246_rp)*s*t*t+(  -0.0000000011054730_rp)*s*s*s*s+(  -0.0000000005381935_rp)*t*t*t*t&
               +(-105.1418142477331941_rp)*s*s*s*t+(-105.1418142527448367_rp)*s*s*t*t+(  -0.0000000037839527_rp)*s*t*t*t
     shaga(15)=   0.0000000000000000_rp+(   0.0000000001082299_rp)*s+(   0.0000000002401066_rp)*t&
               +(  -0.0000000006107257_rp)*s*s+(  -0.0000000013442332_rp)*t*t+( -21.8006479476762252_rp)*s*t&
               +(   0.0000000010202257_rp)*s*s*s+(   0.0000000022464519_rp)*t*t*t+(  21.8006479516582203_rp)*s*s*t&
               +( 126.9424621958696662_rp)*s*t*t+(  -0.0000000005163372_rp)*s*s*s*s+(  -0.0000000011341399_rp)*t*t*t*t&
               +(  -0.0000000037693724_rp)*s*s*s*t+(-105.1418142528167436_rp)*s*s*t*t+(-105.1418142479110429_rp)*s*t*t*t
             
  else
     call runend('SHAGA2: INTERPOLATION NOT AVAILABLE')
  end if
  
end subroutine shaga2
      
