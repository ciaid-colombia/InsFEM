
subroutine shape2(s,t,nnode,shape,deriv,heslo)

!-----------------------------------------------------------------------
!
!    This routine evaluates shape functions and their first and
!    second derivatives for 2-d continuos standar interpolation 
!    elements.
!
!    TRIANGLES       3   6   10  &  15  nodes
!    QUADRILATERALS  4   9   16  &  25  nodes
!
!-----------------------------------------------------------------------

  use      typre
  implicit none
  integer(ip), intent(in)  :: nnode
  real(rp),    intent(in)  :: s,t
  real(rp),    intent(out) :: deriv(2,nnode),shape(nnode),heslo(3,nnode)
  real(rp)                 :: st,ss,tt,s1,s2,s3,s4,t1,t2,t3,t4,s9,t9,c,a
  real(rp)                 :: a1,a2,a3
  real(rp) ::  Nt(5), DNt(5), D2Nt(5), Ns(5), DNs(5), D2Ns(5)
  if(nnode==3) then     
     shape(1)=1.0_rp-s-t                                
     shape(2)=s                                  
     shape(3)=t                                           !  3
     deriv(1,1)=-1.0_rp                                   !   
     deriv(1,2)= 1.0_rp                                   !
     deriv(1,3)= 0.0_rp                                   !
     deriv(2,1)=-1.0_rp                                   !  1       2
     deriv(2,2)= 0.0_rp
     deriv(2,3)= 1.0_rp
  else if(nnode==4) then
     st=s*t                                           
     shape(1)=(1.0_rp-t-s+st)*0.25_rp                     !  4         3
     shape(2)=(1.0_rp-t+s-st)*0.25_rp                     !
     shape(3)=(1.0_rp+t+s+st)*0.25_rp                     !      
     shape(4)=(1.0_rp+t-s-st)*0.25_rp                     !
     deriv(1,1)=(-1.0_rp+t)*0.25_rp                       !  1         2
     deriv(1,2)=(+1.0_rp-t)*0.25_rp
     deriv(1,3)=(+1.0_rp+t)*0.25_rp
     deriv(1,4)=(-1.0_rp-t)*0.25_rp
     deriv(2,1)=(-1.0_rp+s)*0.25_rp
     deriv(2,2)=(-1.0_rp-s)*0.25_rp
     deriv(2,3)=(+1.0_rp+s)*0.25_rp
     deriv(2,4)=(+1.0_rp-s)*0.25_rp
     heslo(3,1)= 0.25_rp
     heslo(3,2)=-0.25_rp
     heslo(3,3)= 0.25_rp
     heslo(3,4)=-0.25_rp
  else if(nnode==6) then
     a1=1.0_rp-s-t
     a2=s                                             
     a3=t
     shape( 1)=(2.0_rp*a1-1.0_rp)*a1                      !  3
     shape( 2)=(2.0_rp*a2-1.0_rp)*a2                      !   
     shape( 3)=(2.0_rp*a3-1.0_rp)*a3                      !   
     shape( 4)=4.0_rp*a1*a2                               !  6     5
     shape( 5)=4.0_rp*a2*a3                               !     
     shape( 6)=4.0_rp*a1*a3                               !   
     deriv(1,1)= 1.0_rp-4.0_rp*a1                         !  1     4     2
     deriv(1,2)= 4.0_rp*a2-1.0_rp    
     deriv(1,3)= 0.0_rp           
     deriv(1,4)= 4.0_rp*(a1-a2)   
     deriv(1,5)= 4.0_rp*a3        
     deriv(1,6)=-4.0_rp*a3       
     deriv(2,1)= 1.0_rp-4.0_rp*a1    
     deriv(2,2)= 0.0_rp           
     deriv(2,3)= 4.0_rp*a3-1.0_rp    
     deriv(2,4)=-4.0_rp*a2       
     deriv(2,5)= 4.0_rp*a2        
     deriv(2,6)= 4.0_rp*(a1-a3)
     heslo(1,1)= 4.0_rp
     heslo(1,2)= 4.0_rp
     heslo(1,4)=-8.0_rp
     heslo(2,1)= 4.0_rp
     heslo(2,3)= 4.0_rp
     heslo(2,6)=-8.0_rp
     heslo(3,1)= 4.0_rp
     heslo(3,4)=-4.0_rp
     heslo(3,5)= 4.0_rp
     heslo(3,6)=-4.0_rp
  else if(nnode==9) then
     ss=s*s
     st=s*t
     tt=t*t
     s1=s+1.0_rp
     t1=t+1.0_rp
     s2=s*2.0_rp
     t2=t*2.0_rp
     s9=s-1.0_rp                               
     t9=t-1.0_rp                                          !  4      7      3
     shape( 1)=0.25_rp*s9*st*t9                           !
     shape( 2)=0.25_rp*s1*st*t9                           !        
     shape( 3)=0.25_rp*s1*st*t1                           !      
     shape( 4)=0.25_rp*s9*st*t1                           !  8      9      6
     shape( 5)=0.5_rp*(1.0_rp-ss)*t*t9                    !    
     shape( 6)=0.5_rp*s*s1*(1.0_rp-tt)                    !   
     shape( 7)=0.5_rp*(1.0_rp-ss)*t*t1                    !  
     shape( 8)=0.5_rp*s*s9*(1.0_rp-tt)                    !  1      5      2
     shape( 9)=(1.0_rp-ss)*(1.0_rp-tt)
     deriv(1,1)= 0.25_rp*t*t9*(-1.0_rp+s2)
     deriv(1,2)= 0.25_rp*(1.0_rp+s2)*t*t9
     deriv(1,3)= 0.25_rp*(1.0_rp+s2)*t*t1
     deriv(1,4)= 0.25_rp*(-1.0_rp+s2)*t*t1
     deriv(1,5)=-st*t9
     deriv(1,6)= 0.5_rp*(1.0_rp+s2)*(1.0_rp-tt)
     deriv(1,7)=-st*t1
     deriv(1,8)= 0.5_rp*(-1.0_rp+s2)*(1.0_rp-tt)
     deriv(1,9)=-s2*(1.0_rp-tt)
     deriv(2,1)= 0.25_rp*(-1.0_rp+t2)*s*s9
     deriv(2,2)= 0.25_rp*s*s1*(-1.0_rp+t2)
     deriv(2,3)= 0.25_rp*s*s1*(1.0_rp+t2)
     deriv(2,4)= 0.25_rp*s*s9*(1.0_rp+t2)
     deriv(2,5)= 0.5_rp*(1.0_rp-ss)*(-1.0_rp+t2)
     deriv(2,6)=-st*s1
     deriv(2,7)= 0.5_rp*(1.0_rp-ss)*(1.0_rp+t2)
     deriv(2,8)=-st*s9
     deriv(2,9)=-t2*(1.0_rp-ss)
     heslo(1,1)= 0.5_rp*t*t9
     heslo(1,2)= 0.5_rp*t*t9
     heslo(1,3)= 0.5_rp*t*t1
     heslo(1,4)= 0.5_rp*t*t1
     heslo(1,5)=-t*t9
     heslo(1,6)= 1.0_rp-tt
     heslo(1,7)=-t*t1
     heslo(1,8)= 1.0_rp-tt
     heslo(1,9)=-2.0_rp*(1.0_rp-tt)
     heslo(2,1)= 0.5_rp*s*s9
     heslo(2,2)= 0.5_rp*s*s1
     heslo(2,3)= 0.5_rp*s*s1
     heslo(2,4)= 0.5_rp*s*s9
     heslo(2,5)= 1.0_rp-ss
     heslo(2,6)=-s*s1
     heslo(2,7)= 1.0_rp-ss
     heslo(2,8)=-s*s9
     heslo(2,9)=-2.0_rp*(1.0_rp-ss)
     heslo(3,1)= 0.25_rp*(-1.0_rp+t2)*(s9+s)
     heslo(3,2)= 0.25_rp*(-1.0_rp+t2)*(s1+s)
     heslo(3,3)= 0.25_rp*(1.0_rp+t2)*(s1+s)
     heslo(3,4)= 0.25_rp*(1.0_rp+t2)*(s9+s)
     heslo(3,5)=-s*(-1.0_rp+t2)
     heslo(3,6)=-t*s1-st
     heslo(3,7)=-s*(1.0_rp+t2)
     heslo(3,8)=-t*s9-st
     heslo(3,9)= s2*t2
  else if(nnode==10) then
     c=9.0_rp/2.0_rp
     a1=(3.0_rp-3.0_rp*s-3.0_rp*t)/3.0_rp
     a2=(2.0_rp-3.0_rp*(s+t))/3.0_rp
     a3=(1.0_rp-3.0_rp*(s+t))/3.0_rp
     shape( 1)=c*a1*a2*a3                                        !  3               
     shape( 2)=c*(3.0_rp*s-1.0_rp)*(3.0_rp*s-2.0_rp)*s/9.0_rp    !            
     shape( 3)=c*(1.0_rp-3.0_rp*t)*(2.0_rp-3.0_rp*t)*t/9.0_rp    !               
     shape( 4)= 3.0_rp*c*a1*a2*s                                 !  8    7  
     shape( 5)=-c*a1*(1.0_rp-3.0_rp*s)*s                         !               
     shape( 6)=-c*(1.0_rp-3.0_rp*s)*s*t                          !               
     shape( 7)=-c*s*(1.0_rp-3.0_rp*t)*t                          !  9   10    6
     shape( 8)=-c*a1*(1.0_rp-3.0_rp*t)*t                         !
     shape( 9)= 3.0_rp*c*a1*a2*t                                 !
     shape(10)= 6.0_rp*c*a1*s*t                                  !  1    4    5    2
     deriv(1, 1)=-c*(a1*a2+a1*a3+a2*a3)       
     deriv(1, 2)=-c*((2.0_rp-3.0_rp*s)/3.0_rp*s&
          + (1.0_rp-3.0_rp*s)/3.0_rp*s-(1.0_rp-3.0_rp*s)*(2.0_rp-3.0_rp*s)/9.0_rp)
     deriv(1, 3)=0.0_rp
     deriv(1, 4)= 3.0_rp*c*(a1*a2-a1*s-a2*s)
     deriv(1, 5)=-3.0_rp*c*(a1*(1.0_rp-3.0_rp*s)/3.0_rp&
          - a1*s-(1.0_rp-3.0_rp*s)*s/3.0_rp)
     deriv(1, 6)=-3.0_rp*c*((1.0_rp-3.0_rp*s)*t/3.0_rp-s*t)
     deriv(1, 7)=-c*(1.0_rp-3.0_rp*t)*t
     deriv(1, 8)= c*(1.0_rp-3.0_rp*t)*t
     deriv(1, 9)= 3.0_rp*c*(-a1*t-a2*t)
     deriv(1,10)= 6.0_rp*c*(a1*t-s*t)
     deriv(2, 1)=-c*(a1*a2+a1*a3+a2*a3)
     deriv(2, 2)= 0.0_rp
     deriv(2, 3)=-c*((2.0_rp-3.0_rp*t)*t/3.0_rp&
          + (1.0_rp-3.0_rp*t)*t/3.0_rp-(1.0_rp-3.0_rp*t)*(2.0_rp-3.0_rp*t)/9.0_rp)
     deriv(2, 4)= 3.0_rp*c*(-a1*s-a2*s)
     deriv(2, 5)=c*(1.0_rp-3.0_rp*s)*s
     deriv(2, 6)=-c*(1.0_rp-3.0_rp*s)*s
     deriv(2, 7)=-3.0_rp*c*((1.0_rp-3.0_rp*t)*s/3.0_rp-s*t)
     deriv(2, 8)=-3.0_rp*c*(-(1.0_rp-3.0_rp*t)*t/3.0_rp&
          - a1*t+a1*(1.0_rp-3.0_rp*t)/3.0_rp)
     deriv(2, 9)= 3.0_rp*c*(-a1*t-a2*t+a1*a2)
     deriv(2,10)= 6.0_rp*c*(a1*s-s*t)
     heslo(1, 1)= c*(6.0_rp*a1+6.0_rp*a2+6.0_rp*a3)/3.0_rp
     heslo(1, 2)=-c*(2.0_rp-6.0_rp*s) 
     heslo(1, 3)= 0.0_rp 
     heslo(1, 4)= c*(-6.0_rp*a1-6.0_rp*a2+6.0_rp*s)
     heslo(1, 5)=-c*(-6.0_rp*a1-2.0_rp*(1.0_rp-3.0_rp*s)+6.0_rp*s) 
     heslo(1, 6)= 6.0_rp*c*t 
     heslo(1, 7)= 0.0_rp 
     heslo(1, 8)= 0.0_rp  
     heslo(1, 9)= 6.0_rp*c*t 
     heslo(1,10)=-12.0_rp*c*t 
     heslo(2, 1)= c*(6.0_rp*a1+6.0_rp*a2+6.0_rp*a3)/3.0_rp 
     heslo(2, 2)= 0.0_rp 
     heslo(2, 3)=-c*(2.0_rp-6.0_rp*t)
     heslo(2, 4)= 6.0_rp*c*s
     heslo(2, 5)= 0.0_rp
     heslo(2, 6)= 0.0_rp
     heslo(2, 7)= 6.0_rp*c*s
     heslo(2, 8)=-c*(-6.0_rp*a1-2.0_rp*(1.0_rp-3.0_rp*t)+6.0_rp*t)
     heslo(2, 9)= c*(-6.0_rp*a1-6.0_rp*a2+6.0_rp*t)
     heslo(2,10)=-12.0_rp*c*s
     heslo(3, 1)= c*(6.0_rp*a1+6.0_rp*a2+6.0_rp*a3)/3.0_rp 
     heslo(3, 2)= 0.0_rp  
     heslo(3, 3)= 0.0_rp 
     heslo(3, 4)= c*(-3.0_rp*a1-3.0_rp*a2+6.0_rp*s) 
     heslo(3, 5)=-c*(-(1.0_rp-3.0_rp*s)+3.0_rp*s) 
     heslo(3, 6)=-c*(1.0_rp-6.0_rp*s)
     heslo(3, 7)=-c*(1.0_rp-6.0_rp*t)
     heslo(3, 8)= c*(1.0_rp-6.0_rp*t) 
     heslo(3, 9)= c*(-3.0_rp*a1-3.0_rp*a2+6.0_rp*t) 
     heslo(3,10)= c*(6.0_rp*a1-6.0_rp*s-6.0_rp*t)
  else if(nnode==16) then
     a =81.0_rp/256.0_rp
     s1=(3.0_rp+3.0_rp*s)/3.0_rp
     s2=(1.0_rp+3.0_rp*s)/3.0_rp
     s3=(1.0_rp-3.0_rp*s)/3.0_rp
     s4=(3.0_rp-3.0_rp*s)/3.0_rp
     t1=(3.0_rp+3.0_rp*t)/3.0_rp
     t2=(1.0_rp+3.0_rp*t)/3.0_rp
     t3=(1.0_rp-3.0_rp*t)/3.0_rp
     t4=(3.0_rp-3.0_rp*t)/3.0_rp
     shape( 1) =   a*s2*s3*s4*t2*t3*t4                   ! 4    10    9    3
     shape( 2) =   a*s1*s2*s3*t2*t3*t4                   ! 
     shape( 3) =   a*s1*s2*s3*t1*t2*t3                   ! 
     shape( 4) =   a*s2*s3*s4*t1*t2*t3                   ! 11   16   15    8
     shape( 5) =-3.0_rp*a*s1*s3*s4*t2*t3*t4              !
     shape( 6) =-3.0_rp*a*s1*s2*s4*t2*t3*t4              !
     shape( 7) =-3.0_rp*a*s1*s2*s3*t1*t3*t4              ! 12   13   14    7
     shape( 8) =-3.0_rp*a*s1*s2*s3*t1*t2*t4              !
     shape( 9) =-3.0_rp*a*s1*s2*s4*t1*t2*t3              !
     shape(10) =-3.0_rp*a*s1*s3*s4*t1*t2*t3              ! 1     5    6    2
     shape(11) =-3.0_rp*a*s2*s3*s4*t1*t2*t4                 
     shape(12) =-3.0_rp*a*s2*s3*s4*t1*t3*t4
     shape(13) = 9.0_rp*a*s1*s3*s4*t1*t3*t4
     shape(14) = 9.0_rp*a*s1*s2*s4*t1*t3*t4
     shape(15) = 9.0_rp*a*s1*s2*s4*t1*t2*t4
     shape(16) = 9.0_rp*a*s1*s3*s4*t1*t2*t4
     deriv(1, 1)=  a *t2*t3*t4*(-s2*s3-s2*s4+s3*s4)
     deriv(1, 2)=  a *t2*t3*t4*(-s1*s2+s1*s3+s2*s3)
     deriv(1, 3)=  a *t1*t2*t3*(-s1*s2+s1*s3+s2*s3)
     deriv(1, 4)=  a *t1*t2*t3*(-s2*s3-s2*s4+s3*s4)
     deriv(1, 5)= -3.0_rp*a*t2*t3*t4*(-s1*s3-s1*s4+s3*s4) 
     deriv(1, 6)=-3.0_rp*a*t2*t3*t4*(-s1*s2+s1*s4+s2*s4)
     deriv(1, 7)=-3.0_rp*a*t1*t3*t4*(-s1*s2+s1*s3+s2*s3)
     deriv(1, 8)=-3.0_rp*a*t1*t2*t4*(-s1*s2+s1*s3+s2*s3)
     deriv(1, 9)=-3.0_rp*a*t1*t2*t3*(-s1*s2+s1*s4+s2*s4)
     deriv(1,10)=-3.0_rp*a*t1*t2*t3*(-s1*s3-s1*s4+s3*s4)
     deriv(1,11)=-3.0_rp*a*t1*t2*t4*(-s2*s3-s2*s4+s3*s4)
     deriv(1,12)=-3.0_rp*a*t1*t3*t4*(-s2*s3-s2*s4+s3*s4)
     deriv(1,13)= 9.0_rp*a*t1*t3*t4*(-s1*s3-s1*s4+s3*s4)
     deriv(1,14)= 9.0_rp*a*t1*t3*t4*(-s1*s2+s1*s4+s2*s4)
     deriv(1,15)= 9.0_rp*a*t1*t2*t4*(-s1*s2+s1*s4+s2*s4)
     deriv(1,16)= 9.0_rp*a*t1*t2*t4*(-s1*s3-s1*s4+s3*s4)
     deriv(2, 1)=  a   *s2*s3*s4*(-t2*t3-t2*t4+t3*t4)
     deriv(2, 2)=  a   *s1*s2*s3*(-t2*t3-t2*t4+t3*t4)
     deriv(2, 3)=  a   *s1*s2*s3*(-t1*t2+t1*t3+t2*t3)
     deriv(2, 4)=  a   *s2*s3*s4*(-t1*t2+t1*t3+t2*t3)
     deriv(2, 5)= -3.0_rp*a *s1*s3*s4*(-t2*t3-t2*t4+t3*t4)
     deriv(2, 6)= -3.0_rp*a *s1*s2*s4*(-t2*t3-t2*t4+t3*t4)
     deriv(2, 7)= -3.0_rp*a *s1*s2*s3*(-t1*t3-t1*t4+t3*t4)
     deriv(2, 8)= -3.0_rp*a *s1*s2*s3*(-t1*t2+t1*t4+t2*t4)
     deriv(2, 9)= -3.0_rp*a *s1*s2*s4*(-t1*t2+t1*t3+t2*t3)
     deriv(2,10)= -3.0_rp*a *s1*s3*s4*(-t1*t2+t1*t3+t2*t3)
     deriv(2,11)= -3.0_rp*a *s2*s3*s4*(-t1*t2+t1*t4+t2*t4)
     deriv(2,12)= -3.0_rp*a *s2*s3*s4*(-t1*t3-t1*t4+t3*t4)
     deriv(2,13)=  9.0_rp*a *s1*s3*s4*(-t1*t3-t1*t4+t3*t4)
     deriv(2,14)=  9.0_rp*a *s1*s2*s4*(-t1*t3-t1*t4+t3*t4)
     deriv(2,15)=  9.0_rp*a *s1*s2*s4*(-t1*t2+t1*t4+t2*t4)
     deriv(2,16)=  9.0_rp*a *s1*s3*s4*(-t1*t2+t1*t4+t2*t4)
     heslo(1, 1) =&
            2.0_rp*a *t2*t3*t4*(s2-s3-s4)
     heslo(1, 2) =&
            2.0_rp*a *t2*t3*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s3)/3.0_rp
     heslo(1, 3) =&
            2.0_rp*a *t1*t2*t3*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s3)/3.0_rp
     heslo(1, 4) =&
            2.0_rp*a *t1*t2*t3*(s2-s3-s4)
     heslo(1, 5) =&
            -2.0_rp*a *t2*t3*t4*(3.0_rp*s1-3.0_rp*s3-3.0_rp*s4)
     heslo(1, 6) =&
            -2.0_rp*a *t2*t3*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s4)
     heslo(1, 7) =&
            -2.0_rp*a *t1*t3*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s3)
     heslo(1, 8) =&
            -2.0_rp*a *t1*t2*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s3)
     heslo(1, 9) =&
            -2.0_rp*a *t1*t2*t3*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s4)
     heslo(1,10) =&
            -2.0_rp*a *t1*t2*t3*(3.0_rp*s1-3.0_rp*s3-3.0_rp*s4)
     heslo(1,11) =&
            -6.0_rp*a *t1*t2*t4*(s2-s3-s4)
     heslo(1,12) =&
            -6.0_rp*a *t1*t3*t4*(s2-s3-s4)
     heslo(1,13) =&
            6.0_rp*a *t1*t3*t4*(3.0_rp*s1-3.0_rp*s3-3.0_rp*s4)
     heslo(1,14) =&
            6.0_rp*a *t1*t3*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s4)
     heslo(1,15) =&
            6.0_rp*a *t1*t2*t4*(-3.0_rp*s1-3.0_rp*s2+3.0_rp*s4)
     heslo(1,16) =&
            6.0_rp*a *t1*t2*t4*(3.0_rp*s1-3.0_rp*s3-3.0_rp*s4)
     heslo(2, 1) =&
            2.0_rp*a *s2*s3*s4*(t2-t3-t4)
     heslo(2, 2) =&
            2.0_rp*a *s1*s2*s3*(t2-t3-t4)
     heslo(2, 3) =&
            2.0_rp*a *s1*s2*s3*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t3)/3.0_rp
     heslo(2, 4) =&
            2.0_rp*a *s2*s3*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t3)/3.0_rp
     heslo(2, 5) =&
            -6.0_rp*a *s1*s3*s4*(t2-t3-t4)
     heslo(2, 6) =&
            -6.0_rp*a *s1*s2*s4*(t2-t3-t4)
     heslo(2, 7) =&
            -2.0_rp*a *s1*s2*s3*(3.0_rp*t1-3.0_rp*t3-3.0_rp*t4)
     heslo(2, 8) =&
            -2.0_rp*a *s1*s2*s3*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t4)
     heslo(2, 9) =&
            -2.0_rp*a *s1*s2*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t3)
     heslo(2,10) =&
            -2.0_rp*a *s1*s3*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t3)
     heslo(2,11) =&
            -2.0_rp*a *s2*s3*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t4)
     heslo(2,12) =&
            -2.0_rp*a *s2*s3*s4*(3.0_rp*t1-3.0_rp*t3-3.0_rp*t4)
     heslo(2,13) =&
            6.0_rp*a *s1*s3*s4*(3.0_rp*t1-3.0_rp*t3-3.0_rp*t4)
     heslo(2,14) =&
            6.0_rp*a *s1*s2*s4*(3.0_rp*t1-3.0_rp*t3-3.0_rp*t4)
     heslo(2,15) =&
            6.0_rp*a *s1*s2*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t4)
     heslo(2,16) =&
            6.0_rp*a *s1*s3*s4*(-3.0_rp*t1-3.0_rp*t2+3.0_rp*t4)
     heslo(3, 1) =&
            a*(-3.0_rp*s2*s3-3.0_rp*s2*s4+3.0_rp*s3*s4)*(-3.0_rp*t2*t3-3.0_rp*t2*t4+3.0_rp*t3*t4)/9.0_rp
     heslo(3, 2) =&
            a*(-3.0_rp*s1*s2+3.0_rp*s1*s3+3.0_rp*s2*s3)*(-3.0_rp*t2*t3-3.0_rp*t2*t4+3.0_rp*t3*t4)/9.0_rp       
     heslo(3, 3) =&
            a*(-3.0_rp*s1*s2+3.0_rp*s1*s3+3.0_rp*s2*s3)*(-3.0_rp*t1*t2+3.0_rp*t1*t3+3.0_rp*t2*t3)/9.0_rp
     heslo(3, 4) =&
            a*(-3.0_rp*s2*s3-3.0_rp*s2*s4+3.0_rp*s3*s4)*(-3.0_rp*t1*t2+3.0_rp*t1*t3+3.0_rp*t2*t3)/9.0_rp
     heslo(3, 5) =&
            -a*(-9.0_rp*s1*s3-9.0_rp*s1*s4+9.0_rp*s3*s4)*(-3.0_rp*t2*t3-3.0_rp*t2*t4+3.0_rp*t3*t4)/9.0_rp
     heslo(3, 6) =&
            -a*(-3.0_rp*s1*s2+3.0_rp*s1*s4+3.0_rp*s2*s4)*(-3.0_rp*t2*t3-3.0_rp*t2*t4+3.0_rp*t3*t4)/3.0_rp
     heslo(3, 7) =&
            -3.0_rp*a*(-s1*s2+s1*s3+s2*s3)*(-t1*t3-t1*t4+t3*t4)
     heslo(3, 8) =&
            -3.0_rp*a*(-s1*s2+s1*s3+s2*s3)*(-t1*t2+t1*t4+t2*t4)
     heslo(3, 9) =&
            -a*(-3.0_rp*s1*s2+3.0_rp*s1*s4+3.0_rp*s2*s4)*(-3.0_rp*t1*t2+3.0_rp*t1*t3+3.0_rp*t2*t3)/3.0_rp
     heslo(3,10) =&
            -a*(-9.0_rp*s1*s3-9.0_rp*s1*s4+9.0_rp*s3*s4)*(-3.0_rp*t1*t2+3.0_rp*t1*t3+3.0_rp*t2*t3)/9.0_rp
     heslo(3,11) =&
            -3.0_rp*a*(-3.0_rp*s2*s3-3.0_rp*s2*s4+3.0_rp*s3*s4)*(-t1*t2+t1*t4+t2*t4)/3.0_rp
     heslo(3,12) =&
            -3.0_rp*a*(-s2*s3-s2*s4+s3*s4)*(-t1*t3-t1*t4+t3*t4)
     heslo(3,13) =&
            9.0_rp*a*(-s1*s3-s1*s4+s3*s4)*(-t1*t3-t1*t4+t3*t4)
     heslo(3,14) =&
            9.0_rp*a*(-s1*s2+s1*s4+s2*s4)*(-t1*t3-t1*t4+t3*t4)
     heslo(3,15) =&
            9.0_rp*a*(-s1*s2+s1*s4+s2*s4)*(-t1*t2+t1*t4+t2*t4)
     heslo(3,16) =&
            9.0_rp*a*(-s1*s3-s1*s4+s3*s4)*(-t1*t2+t1*t4+t2*t4)

! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
! * Valores calculados para triángulos nnode=15. Elemento p4_modificado con posición de nodos para obtener  * 
! * una cuadratura cerrada exacta hasta un polinomio de quinto grado.                                       *
! * Ver la posición de nodos interiores en Regla cerrada para ngaus==15, p5 exacto del archivo rutope.f90   *  
! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   

  else if(nnode==15) then

     shape( 1)= 1.0_rp+(-25.0_rp/3.0_rp)*s+(-25.0_rp/3.0_rp)*t&
               +(70.0_rp/3)*s*s+(70.0_rp/3)*t*t+(55.0_rp*sqrt(7.0_rp)+1890.0_rp)/42.0_rp*s*t&
               +(-80.0_rp/3)*s*s*s+(-80.0_rp/3)*t*t*t-(22.0_rp*sqrt(7.0_rp)+525.0_rp)/7.0_rp*s*s*t&
               -(22.0_rp*sqrt(7.0_rp)+525.0_rp)/7.0_rp*s*t*t+(32.0_rp/3)*s*s*s*s+(32.0_rp/3)*t*t*t*t&
               +(11.0_rp*sqrt(7.0_rp)+236.0_rp)/6.0_rp*s*s*s*t+(11.0_rp*sqrt(7.0_rp)+236.0_rp)/6.0_rp*s*t*t*t&
               +(11.0_rp*sqrt(7.0_rp)+172.0_rp)/3.0_rp*s*s*t*t
     shape( 2)= -s+22.0_rp/3.0_rp*s*s-(11.0_rp*sqrt(7.0_rp)-35.0_rp)/21.0_rp*s*t-16.0_rp*s*s*s&
                +(33.0_rp*sqrt(7.0_rp)-70.0_rp)/14.0_rp*s*s*t+(11.0_rp*sqrt(7.0_rp)-35.0_rp)/21.0_rp*s*t*t&
                +32.0_rp/3.0_rp*s*s*s*s-(11.0_rp*sqrt(7.0_rp)-20.0_rp)/6.0_rp*s*s*s*t&
                -(11.0_rp*sqrt(7.0_rp)-20.0_rp)/6.0_rp*s*s*t*t
     shape( 3)= -t+22.0_rp/3.0_rp*t*t-(11.0_rp*sqrt(7.0_rp)-35.0_rp)/21.0_rp*s*t-16.0_rp*t*t*t&
                +(11.0_rp*sqrt(7.0_rp)-35.0_rp)/21.0_rp*s*s*t+(33.0_rp*sqrt(7.0_rp)-70.0_rp)/14.0_rp*s*t*t&
                +32.0_rp/3.0_rp*t*t*t*t-(11.0_rp*sqrt(7.0_rp)-20.0_rp)/6.0_rp*s*t*t*t&
                -(11.0_rp*sqrt(7.0_rp)-20.0_rp)/6.0_rp*s*s*t*t
     shape( 4)=  16.0_rp*s-208.0_rp/3.0_rp*s*s-(104.0_rp*sqrt(7.0_rp)+1400.0_rp)/21.0_rp*s*t&
                +96.0_rp*s*s*s+(72.0_rp*sqrt(7.0_rp)+1288.0_rp)/7.0_rp*s*s*t+(272.0_rp*sqrt(7.0_rp)+1792.0_rp)/21.0_rp*s*t*t&
                -128.0_rp/3.0_rp*s*s*s*s-(16.0_rp*sqrt(7.0_rp)+368.0_rp)/3.0_rp*s*s*s*t&
                -(24.0_rp*sqrt(7.0_rp)+104.0_rp)/3.0_rp*s*t*t*t-(40.0_rp*sqrt(7.0_rp)+344.0_rp)/3.0_rp*s*s*t*t
     shape( 5)= -12.0_rp*s+76.0_rp*s*s+(66.0_rp*sqrt(7.0_rp)+70.0_rp)/7.0_rp*s*t-128.0_rp*s*s*s&
                -(66.0_rp*sqrt(7.0_rp)+882.0_rp)/7.0_rp*s*s*t-(220.0_rp*sqrt(7.0_rp)-336.0_rp)/7.0_rp*s*t*t&
                +64.0_rp*s*s*s*s+128.0_rp*s*s*s*t+(22.0_rp*sqrt(7.0_rp)-46.0_rp)*s*t*t*t+(22.0_rp*sqrt(7.0_rp)+18.0_rp)*s*s*t*t
    shape( 6)= 16.0_rp/3.0_rp*s-112.0_rp/3.0_rp*s*s+(8.0_rp*sqrt(7.0_rp)-168.0_rp)/21.0_rp*s*t&
               +224.0_rp/3.0_rp*s*s*s-(40.0_rp*sqrt(7.0_rp)-280.0_rp)/7.0_rp*s*s*t&
               +16.0_rp*sqrt(7.0_rp)/7.0_rp*s*t*t-128.0_rp/3.0_rp*s*s*s*s+(16.0_rp*sqrt(7.0_rp)-144.0_rp)/3.0_rp*s*s*s*t&
               -(8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*t*t*t+(8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*s*t*t
     shape( 7)=  (64.0_rp*sqrt(7.0_rp))/21.0_rp*s*t -(232.0_rp*sqrt(7.0_rp)+392.0_rp)/21.0_rp*s*s*t&
               - (40.0_rp*sqrt(7.0_rp)-56.0_rp)/7.0_rp*s*t*t + (24.0_rp*sqrt(7.0_rp)+104.0_rp)/3.0_rp*s*s*s*t&
               + (8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*t*t*t+(32.0_rp*sqrt(7.0_rp)-32.0_rp)/3.0_rp*s*s*t*t
     shape( 8)=-(88.0_rp*sqrt(7.0_rp)-224.0_rp)/7.0_rp*s*t + (242.0_rp*sqrt(7.0_rp)-630.0_rp)/7.0_rp*s*s*t&
               + (242.0_rp*sqrt(7.0_rp)-630.0_rp)/7.0_rp*s*t*t + (46.0_rp-22.0_rp*sqrt(7.0_rp))*s*s*s*t&
               + (46.0_rp-22.0_rp*sqrt(7.0_rp))*s*t*t*t + (156.0_rp-44.0_rp*sqrt(7.0_rp))*s*s*t*t 
     shape( 9)= +(64.0_rp*sqrt(7.0_rp))/21.0_rp*s*t - (40.0_rp*sqrt(7.0_rp)-56.0_rp)/7.0_rp*s*s*t&
                -(232.0_rp*sqrt(7.0_rp)+392.0_rp)/21.0_rp*s*t*t + (8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*s*s*t&
                +(24.0_rp*sqrt(7.0_rp)+104.0_rp)/3.0_rp*s*t*t*t+(32.0_rp*sqrt(7.0_rp)-32.0_rp)/3.0_rp*s*s*t*t
     shape(10)= 16.0_rp/3.0_rp*t-112.0_rp/3.0_rp*t*t+(8.0_rp*sqrt(7.0_rp)-168.0_rp)/21.0_rp*s*t&
               +224.0_rp/3.0_rp*t*t*t+16.0_rp*sqrt(7.0_rp)/7.0_rp*s*s*t-(40.0_rp*sqrt(7.0_rp)-280.0_rp)/7.0_rp*s*t*t&
               -128.0_rp/3.0_rp*t*t*t*t-(8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*s*s*t&
               +(16.0_rp*sqrt(7.0_rp)-144.0_rp)/3.0_rp*s*t*t*t+(8.0_rp*sqrt(7.0_rp)-8.0_rp)/3.0_rp*s*s*t*t
     shape(11)= -12.0_rp*t+76.0_rp*t*t+(66.0_rp*sqrt(7.0_rp)+70.0_rp)/7.0_rp*s*t-128.0_rp*t*t*t&
                -(220.0_rp*sqrt(7.0_rp)-336.0_rp)/7.0_rp*s*s*t-(66.0_rp*sqrt(7.0_rp)+882.0_rp)/7.0_rp*s*t*t&
                +64.0_rp*t*t*t*t+(22.0_rp*sqrt(7.0_rp)-46)*s*s*s*t+128.0_rp*s*t*t*t+(22.0_rp*sqrt(7.0_rp)+18.0_rp)*s*s*t*t
     shape(12)= 16.0_rp*t-208.0_rp/3.0_rp*t*t-(104.0_rp*sqrt(7.0_rp)+1400.0_rp)/21.0_rp*s*t+96.0_rp*t*t*t&
               +(272.0_rp*sqrt(7.0_rp)+1792.0_rp)/21.0_rp*s*s*t+(72.0_rp*sqrt(7.0_rp)+1288.0_rp)/7.0_rp*s*t*t&
               -128.0_rp/3.0_rp*t*t*t*t-(24.0_rp*sqrt(7.0_rp)+104.0_rp)/3.0_rp*s*s*s*t&
               -(16.0_rp*sqrt(7.0_rp)+368.0_rp)/3.0_rp*s*t*t*t-(40.0_rp*sqrt(7.0_rp)+344.0_rp)/3.0_rp*s*s*t*t
     shape(13)= (9.0_rp*sqrt(7.0_rp**3))/2.0_rp*s*t - (23.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*s*t&
               -(23.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*t*t+(2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*s*s*t&
               +(2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*t*t*t+(2.0_rp*sqrt(7.0_rp**5)-49.0_rp)*s*s*t*t
     shape(14)=-(5.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*t + (19.0_rp*sqrt(7.0_rp**3)-98.0_rp)/2.0_rp*s*s*t&
               +(5.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*t*t - (2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*s*s*t&
               -(2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*s*t*t
     shape(15)=-(5.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*t + (5.0_rp*sqrt(7.0_rp**3)-49.0_rp)/2.0_rp*s*s*t&
               +(19.0_rp*sqrt(7.0_rp**3)-98.0_rp)/2.0_rp*s*t*t - (2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*s*t*t&
               -(2.0_rp*sqrt(7.0_rp**5)-49.0_rp)/2.0_rp*s*t*t*t

     deriv(1, 1)=  -8.3333333334921917_rp+2*(  23.3333333342179685_rp)*s+(  48.4646743398957369_rp)*t&
                +3*( -26.6666666681470019_rp)*s*s+2*( -83.3152184149769255_rp)*s*t+( -83.3152184151310848_rp)*t*t&
                +4*(  10.6666666674143897_rp)*s*s*s+3*(  44.1838774082058023_rp)*s*s*t+2*(  67.0344214842568249_rp)*s*t*t&
                +(  44.1838774082991677_rp)*t*t*t
     deriv(1, 2)=  -0.9999999999974740_rp+2*(   7.3333333333189632_rp)*s+(   0.2807969323081281_rp)*t&
                +3*( -15.9999999999762199_rp)*s*s+2*(   1.2364138045634334_rp)*s*t+(  -0.2807969322706239_rp)*t*t&
                +4*(  10.6666666666547059_rp)*s*s*s+3*(  -1.5172107368690897_rp)*s*s*t+2*(  -1.5172107369162715_rp)*s*t*t&
                +(  -0.0000000000342917_rp)*t*t*t
     deriv(1, 3)=   0.0000000000009095_rp+2*(  -0.0000000000048423_rp)*s+(   0.2807969323084976_rp)*t&
                +3*(   0.0000000000081046_rp)*s*s+2*(  -0.2807969322737502_rp)*s*t+(   1.2364138045616002_rp)*t*t&
                +4*(  -0.0000000000040843_rp)*s*s*s+3*(  -0.0000000000324771_rp)*s*s*t+2*(  -1.5172107369120971_rp)*s*t*t&
                +(  -1.5172107368673551_rp)*t*t*t
     deriv(1, 4)=  16.0000000003747118_rp+2*( -69.3333333354410115_rp)*s+( -79.7694350723932075_rp)*t&
                +3*(  96.0000000035275320_rp)*s*s+2*( 211.2134420756940472_rp)*s*t+( 119.6021122364136318_rp)*t*t&
                +4*( -42.6666666684495084_rp)*s*s*s+3*(-136.7773403361930775_rp)*s*s*t+2*(-149.9433508352551598_rp)*s*t*t&
                +( -55.8326771634506258_rp)*t*t*t
     deriv(1, 5)= -12.0000000002560228_rp+2*(  76.0000000014252919_rp)*s+(  34.9456552233868933_rp)*t&
                +3*(-128.0000000023889015_rp)*s*s+2*(-150.9456552308158734_rp)*s*t+( -35.1521840712055109_rp)*t*t&
                +4*(  64.0000000012041710_rp)*s*s*s+3*( 128.0000000071673867_rp)*s*s*t+2*(  76.2065288559824694_rp)*s*t*t&
                +(  12.2065288474843783_rp)*t*t*t
     deriv(1, 6)=   5.3333333333723658_rp+2*( -37.3333333335594801_rp)*s+(  -6.9920947394621180_rp)*t&
                +3*(  74.6666666670428043_rp)*s*s+2*(  24.8814210820214541_rp)*s*t+(   6.0474315694772400_rp)*t*t&
                +4*( -42.6666666668577079_rp)*s*s*s+3*( -33.8893263425222955_rp)*s*s*t+2*(   4.3886701606570888_rp)*s*t*t&
                +(  -4.3886701633013701_rp)*t*t*t
     deriv(1, 7)=  -0.0000000000853788_rp+2*(   0.0000000004719141_rp)*s+(   8.0632420921942867_rp)*t&
                +3*(  -0.0000000007879990_rp)*s*s+2*( -47.8959192493797872_rp)*s*t+(  -7.1185789229376155_rp)*t*t&
                +4*(   0.0000000003987015_rp)*s*s*s+3*(  55.8326771571037881_rp)*s*s*t+2*(  17.5546806548235281_rp)*s*t*t&
                +(   4.3886701639723640_rp)*t*t*t
     deriv(1, 8)=  -0.0000000000146656_rp+2*(   0.0000000000808882_rp)*s+(  -1.2608736244689567_rp)*t&
                +3*(  -0.0000000001355609_rp)*s*s+2*(   1.4674024674377790_rp)*s*t+(   1.4674024674318957_rp)*t*t&
                +4*(   0.0000000000681117_rp)*s*s*s+3*( -12.2065288429870833_rp)*s*s*t+2*(  39.5869423141255865_rp)*s*t*t&
                +( -12.2065288429873533_rp)*t*t*t
     deriv(1, 9)=  -0.0000000000309228_rp+2*(   0.0000000001664375_rp)*s+(   8.0632420922024721_rp)*t&
                +3*(  -0.0000000002787885_rp)*s*s+2*(  -7.1185789229073748_rp)*s*t+( -47.8959192494714898_rp)*t*t&
                +4*(   0.0000000001408225_rp)*s*s*s+3*(   4.3886701639702750_rp)*s*s*t+2*(  17.5546806548536551_rp)*s*t*t&
                +(  55.8326771571770450_rp)*t*t*t
     deriv(1,10)=   0.0000000000113687_rp+2*(  -0.0000000000623004_rp)*s+(  -6.9920947394698487_rp)*t&
                +3*(   0.0000000001044782_rp)*s*s+2*(   6.0474315694737584_rp)*s*t+(  24.8814210820885933_rp)*t*t&
                +4*(  -0.0000000000528626_rp)*s*s*s+3*(  -4.3886701633092073_rp)*s*s*t+2*(   4.3886701606180765_rp)*s*t*t&
                +( -33.8893263425786131_rp)*t*t*t
     deriv(1,11)=  -0.0000000001164153_rp+2*(   0.0000000006548362_rp)*s+(  34.9456552234114497_rp)*t&
                +3*(  -0.0000000010986128_rp)*s*s+2*( -35.1521840711213827_rp)*s*t+(-150.9456552311207815_rp)*t*t&
                +4*(   0.0000000005536549_rp)*s*s*s+3*(  12.2065288474785518_rp)*s*s*t+2*(  76.2065288561027501_rp)*s*t*t&
                +( 128.0000000074010131_rp)*t*t*t
     deriv(1,12)=   0.0000000002710294_rp+2*(  -0.0000000015311343_rp)*s+( -79.7694350724123069_rp)*t&
                +3*(   0.0000000025710278_rp)*s*s+2*( 119.6021122361757989_rp)*s*t+( 211.2134420760958164_rp)*t*t&
                +4*(  -0.0000000012939552_rp)*s*s*s+3*( -55.8326771633475119_rp)*s*s*t+2*(-149.9433508353474735_rp)*s*t*t&
                +(-136.7773403364694786_rp)*t*t*t
     deriv(1,13)=  -0.0000000003819878_rp+2*(   0.0000000021809683_rp)*s+(  83.3411663078350102_rp)*t&
                +3*(  -0.0000000036493475_rp)*s*s+2*(-188.4829805611818756_rp)*s*t+(-188.4829805615527221_rp)*t*t&
                +4*(   0.0000000018402773_rp)*s*s*s+3*( 105.1418142528370367_rp)*s*s*t+2*( 210.2836285085713826_rp)*s*t*t&
                +( 105.1418142530505975_rp)*t*t*t
     deriv(1,14)=   0.0000000002305569_rp+2*(  -0.0000000013075123_rp)*s+( -21.8006479476589448_rp)*t&
                +3*(   0.0000000021808262_rp)*s*s+2*( 126.9424621956307533_rp)*s*t+(  21.8006479517496246_rp)*t*t&
                +4*(  -0.0000000011054730_rp)*s*s*s+3*(-105.1418142477331941_rp)*s*s*t+2*(-105.1418142527448367_rp)*s*t*t&
                +(  -0.0000000037839527_rp)*t*t*t
     deriv(1,15)=   0.0000000001082299_rp+2*(  -0.0000000006107257_rp)*s+( -21.8006479476762252_rp)*t&
                +3*(   0.0000000010202257_rp)*s*s+2*(  21.8006479516582203_rp)*s*t+( 126.9424621958696662_rp)*t*t&
                +4*(  -0.0000000005163372_rp)*s*s*s+3*(  -0.0000000037693724_rp)*s*s*t+2*(-105.1418142528167436_rp)*s*t*t&
                +(-105.1418142479110429_rp)*t*t*t

     deriv(2, 1)=  -8.3333333334921917_rp+2*(  23.3333333342488913_rp)*t+(  48.4646743398957369_rp)*s&
                +3*( -26.6666666681967399_rp)*t*t+( -83.3152184149769255_rp)*s*s+2*( -83.3152184151310848_rp)*s*t&
                +4*(  10.6666666674386761_rp)*t*t*t+(  44.1838774082058023_rp)*s*s*s+2*(  67.0344214842568249_rp)*s*s*t&
                +3*(  44.1838774082991677_rp)*s*t*t
     deriv(2, 2)=   0.0000000000008811_rp+2*(  -0.0000000000051514_rp)*t+(   0.2807969323081281_rp)*s&
                +3*(   0.0000000000085656_rp)*t*t+(   1.2364138045634334_rp)*s*s+2*(  -0.2807969322706239_rp)*s*t&
                +4*(  -0.0000000000043308_rp)*t*t*t+(  -1.5172107368690897_rp)*s*s*s+2*(  -1.5172107369162715_rp)*s*s*t&
                +3*(  -0.0000000000342917_rp)*s*t*t
     deriv(2, 3)=  -0.9999999999976126_rp+2*(   7.3333333333196151_rp)*t+(   0.2807969323084976_rp)*s&
                +3*( -15.9999999999765521_rp)*t*t+(  -0.2807969322737502_rp)*s*s+2*(   1.2364138045616002_rp)*s*t&
                +4*(  10.6666666666549830_rp)*t*t*t+(  -0.0000000000324771_rp)*s*s*s+2*(  -1.5172107369120971_rp)*s*s*t&
                +3*(  -1.5172107368673551_rp)*s*t*t
     deriv(2, 4)=   0.0000000002874003_rp+2*(  -0.0000000015916157_rp)*t+( -79.7694350723932075_rp)*s&
                +3*(   0.0000000026575435_rp)*t*t+( 211.2134420756940472_rp)*s*s+2*( 119.6021122364136318_rp)*s*t&
                +4*(  -0.0000000013415047_rp)*t*t*t+(-136.7773403361930775_rp)*s*s*s+2*(-149.9433508352551598_rp)*s*s*t&
                +3*( -55.8326771634506258_rp)*s*t*t
     deriv(2, 5)=  -0.0000000001236913_rp+2*(   0.0000000006839400_rp)*t+(  34.9456552233868933_rp)*s&
                +3*(  -0.0000000011459633_rp)*t*t+(-150.9456552308158734_rp)*s*s+2*( -35.1521840712055109_rp)*s*t&
                +4*(   0.0000000005770744_rp)*t*t*t+( 128.0000000071673867_rp)*s*s*s+2*(  76.2065288559824694_rp)*s*s*t&
                +3*(  12.2065288474843783_rp)*s*t*t
     deriv(2, 6)=   0.0000000000118234_rp+2*(  -0.0000000000662794_rp)*t+(  -6.9920947394621180_rp)*s&
                +3*(   0.0000000001102194_rp)*t*t+(  24.8814210820214541_rp)*s*s+2*(   6.0474315694772400_rp)*s*t&
                +4*(  -0.0000000000557918_rp)*t*t*t+( -33.8893263425222955_rp)*s*s*s+2*(   4.3886701606570888_rp)*s*s*t&
                +3*(  -4.3886701633013701_rp)*s*t*t
     deriv(2, 7)=  -0.0000000000313776_rp+2*(   0.0000000001753051_rp)*t+(   8.0632420921942867_rp)*s&
                +3*(  -0.0000000002929710_rp)*t*t+( -47.8959192493797872_rp)*s*s+2*(  -7.1185789229376155_rp)*s*t&
                +4*(   0.0000000001480203_rp)*t*t*t+(  55.8326771571037881_rp)*s*s*s+2*(  17.5546806548235281_rp)*s*s*t&
                +3*(   4.3886701639723640_rp)*s*t*t
     deriv(2, 8)=  -0.0000000000147793_rp+2*(   0.0000000000837872_rp)*t+(  -1.2608736244689567_rp)*s&
                +3*(  -0.0000000001402896_rp)*t*t+(   1.4674024674377790_rp)*s*s+2*(   1.4674024674318957_rp)*s*t&
                +4*(   0.0000000000704858_rp)*t*t*t+( -12.2065288429870833_rp)*s*s*s+2*(  39.5869423141255865_rp)*s*s*t&
                +3*( -12.2065288429873533_rp)*s*t*t
     deriv(2, 9)=  -0.0000000000836735_rp+2*(   0.0000000004856702_rp)*t+(   8.0632420922024721_rp)*s&
                +3*(  -0.0000000008099050_rp)*t*t+(  -7.1185789229073748_rp)*s*s+2*( -47.8959192494714898_rp)*s*t&
                +4*(   0.0000000004104095_rp)*t*t*t+(   4.3886701639702750_rp)*s*s*s+2*(  17.5546806548536551_rp)*s*s*t&
                +3*(  55.8326771571770450_rp)*s*t*t
     deriv(2,10)=   5.3333333333748669_rp+2*( -37.3333333335672251_rp)*t+(  -6.9920947394698487_rp)*s&
                +3*(  74.6666666670587347_rp)*t*t+(   6.0474315694737584_rp)*s*s+2*(  24.8814210820885933_rp)*s*t&
                +4*( -42.6666666668641028_rp)*t*t*t+(  -4.3886701633092073_rp)*s*s*s+2*(   4.3886701606180765_rp)*s*s*t&
                +3*( -33.8893263425786131_rp)*s*t*t
     deriv(2,11)= -12.0000000002619345_rp+2*(  76.0000000014715624_rp)*t+(  34.9456552234114497_rp)*s&
                +3*(-128.0000000024665496_rp)*t*t+( -35.1521840711213827_rp)*s*s+2*(-150.9456552311207815_rp)*s*t&
                +4*(  64.0000000012423698_rp)*t*t*t+(  12.2065288474785518_rp)*s*s*s+2*(  76.2065288561027501_rp)*s*s*t&
                +3*( 128.0000000074010131_rp)*s*t*t
     deriv(2,12)=  16.0000000003929017_rp+2*( -69.3333333355112700_rp)*t+( -79.7694350724123069_rp)*s&
                +3*(  96.0000000036416168_rp)*t*t+( 119.6021122361757989_rp)*s*s+2*( 211.2134420760958164_rp)*s*t&
                +4*( -42.6666666685041491_rp)*t*t*t+( -55.8326771633475119_rp)*s*s*s+2*(-149.9433508353474735_rp)*s*s*t&
                +3*(-136.7773403364694786_rp)*s*t*t
     deriv(2,13)=  -0.0000000004001777_rp+2*(   0.0000000022519089_rp)*t+(  83.3411663078350102_rp)*s&
                +3*(  -0.0000000037653081_rp)*t*t+(-188.4829805611818756_rp)*s*s+2*(-188.4829805615527221_rp)*s*t&
                +4*(   0.0000000019017534_rp)*t*t*t+( 105.1418142528370367_rp)*s*s*s+2*( 210.2836285085713826_rp)*s*s*t&
                +3*( 105.1418142530505975_rp)*s*t*t
     deriv(2,14)=   0.0000000001127773_rp+2*(  -0.0000000006393748_rp)*t+( -21.8006479476589448_rp)*s&
                +3*(   0.0000000010663825_rp)*t*t+( 126.9424621956307533_rp)*s*s+2*(  21.8006479517496246_rp)*s*t&
                +4*(  -0.0000000005381935_rp)*t*t*t+(-105.1418142477331941_rp)*s*s*s+2*(-105.1418142527448367_rp)*s*s*t&
                +3*(  -0.0000000037839527_rp)*s*t*t
     deriv(2,15)=   0.0000000002401066_rp+2*(  -0.0000000013442332_rp)*t+( -21.8006479476762252_rp)*s&
                +3*(   0.0000000022464519_rp)*t*t+(  21.8006479516582203_rp)*s*s+2*( 126.9424621958696662_rp)*s*t&
                +4*(  -0.0000000011341399_rp)*t*t*t+(  -0.0000000037693724_rp)*s*s*s+2*(-105.1418142528167436_rp)*s*s*t&
                +3*(-105.1418142479110429_rp)*s*t*t

     heslo(1, 1)= 2*(  23.3333333342179685_rp)+6*( -26.6666666681470019_rp)*s+2*( -83.3152184149769255_rp)*t&
                +12*(  10.6666666674143897_rp)*s*s+6*(  44.1838774082058023_rp)*s*t+2*(  67.0344214842568249_rp)*t*t
     heslo(1, 2)= 2*(   7.3333333333189632_rp)+6*( -15.9999999999762199_rp)*s+2*(   1.2364138045634334_rp)*t&
                +12*(  10.6666666666547059_rp)*s*s+6*(  -1.5172107368690897_rp)*s*t+2*(  -1.5172107369162715_rp)*t*t
     heslo(1, 3)= 2*(  -0.0000000000048423_rp)+6*(   0.0000000000081046_rp)*s+2*(  -0.2807969322737502_rp)*t&
                +12*(  -0.0000000000040843_rp)*s*s+6*(  -0.0000000000324771_rp)*s*t+2*(  -1.5172107369120971_rp)*t*t
     heslo(1, 4)= 2*( -69.3333333354410115_rp)+6*(  96.0000000035275320_rp)*s+2*( 211.2134420756940472_rp)*t&
                +12*( -42.6666666684495084_rp)*s*s+6*(-136.7773403361930775_rp)*s*t+2*(-149.9433508352551598_rp)*t*t
     heslo(1, 5)= 2*(  76.0000000014252919_rp)+6*(-128.0000000023889015_rp)*s+2*(-150.9456552308158734_rp)*t&
                +12*(  64.0000000012041710_rp)*s*s+6*( 128.0000000071673867_rp)*s*t+2*(  76.2065288559824694_rp)*t*t
     heslo(1, 6)= 2*( -37.3333333335594801_rp)+6*(  74.6666666670428043_rp)*s+2*(  24.8814210820214541_rp)*t&
                +12*( -42.6666666668577079_rp)*s*s+6*( -33.8893263425222955_rp)*s*t+2*(   4.3886701606570888_rp)*t*t
     heslo(1, 7)= 2*(   0.0000000004719141_rp)+6*(  -0.0000000007879990_rp)*s+2*( -47.8959192493797872_rp)*t&
                +12*(   0.0000000003987015_rp)*s*s+6*(  55.8326771571037881_rp)*s*t+2*(  17.5546806548235281_rp)*t*t
     heslo(1, 8)= 2*(   0.0000000000808882_rp)+6*(  -0.0000000001355609_rp)*s+2*(   1.4674024674377790_rp)*t&
                +12*(   0.0000000000681117_rp)*s*s+6*( -12.2065288429870833_rp)*s*t+2*(  39.5869423141255865_rp)*t*t
     heslo(1, 9)= 2*(   0.0000000001664375_rp)+6*(  -0.0000000002787885_rp)*s+2*(  -7.1185789229073748_rp)*t&
                +12*(   0.0000000001408225_rp)*s*s+6*(   4.3886701639702750_rp)*s*t+2*(  17.5546806548536551_rp)*t*t
     heslo(1,10)= 2*(  -0.0000000000623004_rp)+6*(   0.0000000001044782_rp)*s+2*(   6.0474315694737584_rp)*t&
                +12*(  -0.0000000000528626_rp)*s*s+6*(  -4.3886701633092073_rp)*s*t+2*(   4.3886701606180765_rp)*t*t
     heslo(1,11)= 2*(   0.0000000006548362_rp)+6*(  -0.0000000010986128_rp)*s+2*( -35.1521840711213827_rp)*t&
                +12*(   0.0000000005536549_rp)*s*s+6*(  12.2065288474785518_rp)*s*t+2*(  76.2065288561027501_rp)*t*t
     heslo(1,12)= 2*(  -0.0000000015311343_rp)+6*(   0.0000000025710278_rp)*s+2*( 119.6021122361757989_rp)*t&
                +12*(  -0.0000000012939552_rp)*s*s+6*( -55.8326771633475119_rp)*s*t+2*(-149.9433508353474735_rp)*t*t
     heslo(1,13)= 2*(   0.0000000021809683_rp)+6*(  -0.0000000036493475_rp)*s+2*(-188.4829805611818756_rp)*t&
                +12*(   0.0000000018402773_rp)*s*s+6*( 105.1418142528370367_rp)*s*t+2*( 210.2836285085713826_rp)*t*t
     heslo(1,14)= 2*(  -0.0000000013075123_rp)+6*(   0.0000000021808262_rp)*s+2*( 126.9424621956307533_rp)*t&
                +12*(  -0.0000000011054730_rp)*s*s+6*(-105.1418142477331941_rp)*s*t+2*(-105.1418142527448367_rp)*t*t
     heslo(1,15)= 2*(  -0.0000000006107257_rp)+6*(   0.0000000010202257_rp)*s+2*(  21.8006479516582203_rp)*t&
                +12*(  -0.0000000005163372_rp)*s*s+6*(  -0.0000000037693724_rp)*s*t+2*(-105.1418142528167436_rp)*t*t

     heslo(2, 1)= 2*(  23.3333333342488913_rp)+6*( -26.6666666681967399_rp)*t+2*( -83.3152184151310848_rp)*s&
                +12*(  10.6666666674386761_rp)*t*t+2*(  67.0344214842568249_rp)*s*s+6*(  44.1838774082991677_rp)*s*t
     heslo(2, 2)= 2*(  -0.0000000000051514_rp)+6*(   0.0000000000085656_rp)*t+2*(  -0.2807969322706239_rp)*s&
                +12*(  -0.0000000000043308_rp)*t*t+2*(  -1.5172107369162715_rp)*s*s+6*(  -0.0000000000342917_rp)*s*t
     heslo(2, 3)= 2*(   7.3333333333196151_rp)+6*( -15.9999999999765521_rp)*t+2*(   1.2364138045616002_rp)*s&
                +12*(  10.6666666666549830_rp)*t*t+2*(  -1.5172107369120971_rp)*s*s+6*(  -1.5172107368673551_rp)*s*t
     heslo(2, 4)= 2*(  -0.0000000015916157_rp)+6*(   0.0000000026575435_rp)*t+2*( 119.6021122364136318_rp)*s&
                +12*(  -0.0000000013415047_rp)*t*t+2*(-149.9433508352551598_rp)*s*s+6*( -55.8326771634506258_rp)*s*t
     heslo(2, 5)= 2*(   0.0000000006839400_rp)+6*(  -0.0000000011459633_rp)*t+2*( -35.1521840712055109_rp)*s&
                +12*(   0.0000000005770744_rp)*t*t+2*(  76.2065288559824694_rp)*s*s+6*(  12.2065288474843783_rp)*s*t
     heslo(2, 6)= 2*(  -0.0000000000662794_rp)+6*(   0.0000000001102194_rp)*t+2*(   6.0474315694772400_rp)*s&
                +12*(  -0.0000000000557918_rp)*t*t+2*(   4.3886701606570888_rp)*s*s+6*(  -4.3886701633013701_rp)*s*t
     heslo(2, 7)= 2*(   0.0000000001753051_rp)+6*(  -0.0000000002929710_rp)*t+2*(  -7.1185789229376155_rp)*s&
                +12*(   0.0000000001480203_rp)*t*t+2*(  17.5546806548235281_rp)*s*s+6*(   4.3886701639723640_rp)*s*t
     heslo(2, 8)= 2*(   0.0000000000837872_rp)+6*(  -0.0000000001402896_rp)*t+2*(   1.4674024674318957_rp)*s&
                +12*(   0.0000000000704858_rp)*t*t+2*(  39.5869423141255865_rp)*s*s+6*( -12.2065288429873533_rp)*s*t
     heslo(2, 9)= 2*(   0.0000000004856702_rp)+6*(  -0.0000000008099050_rp)*t+2*( -47.8959192494714898_rp)*s&
                +12*(   0.0000000004104095_rp)*t*t+2*(  17.5546806548536551_rp)*s*s+6*(  55.8326771571770450_rp)*s*t
     heslo(2,10)= 2*( -37.3333333335672251_rp)+6*(  74.6666666670587347_rp)*t+2*(  24.8814210820885933_rp)*s&
                +12*( -42.6666666668641028_rp)*t*t+2*(   4.3886701606180765_rp)*s*s+6*( -33.8893263425786131_rp)*s*t
     heslo(2,11)= 2*(  76.0000000014715624_rp)+6*(-128.0000000024665496_rp)*t+2*(-150.9456552311207815_rp)*s&
                +12*(  64.0000000012423698_rp)*t*t+2*(  76.2065288561027501_rp)*s*s+6*( 128.0000000074010131_rp)*s*t
     heslo(2,12)= 2*( -69.3333333355112700_rp)+6*(  96.0000000036416168_rp)*t+2*( 211.2134420760958164_rp)*s&
                +12*( -42.6666666685041491_rp)*t*t+2*(-149.9433508353474735_rp)*s*s+6*(-136.7773403364694786_rp)*s*t
     heslo(2,13)= 2*(   0.0000000022519089_rp)+6*(  -0.0000000037653081_rp)*t+2*(-188.4829805615527221_rp)*s&
                +12*(   0.0000000019017534_rp)*t*t+2*( 210.2836285085713826_rp)*s*s+6*( 105.1418142530505975_rp)*s*t
     heslo(2,14)= 2*(  -0.0000000006393748_rp)+6*(   0.0000000010663825_rp)*t+2*(  21.8006479517496246_rp)*s&
                +12*(  -0.0000000005381935_rp)*t*t+2*(-105.1418142527448367_rp)*s*s+6*(  -0.0000000037839527_rp)*s*t
     heslo(2,15)= 2*(  -0.0000000013442332_rp)+6*(   0.0000000022464519_rp)*t+2*( 126.9424621958696662_rp)*s&
                +12*(  -0.0000000011341399_rp)*t*t+2*(-105.1418142528167436_rp)*s*s+6*(-105.1418142479110429_rp)*s*t

     heslo(3, 1)=   48.4646743398957369_rp+2*( -83.3152184149769255_rp)*s+2*( -83.3152184151310848_rp)*t&
                +3*(  44.1838774082058023_rp)*s*s+4*(  67.0344214842568249_rp)*s*t+3*(  44.1838774082991677_rp)*t*t
     heslo(3, 2)=    0.2807969323081281_rp+2*(   1.2364138045634334_rp)*s+2*(  -0.2807969322706239_rp)*t&
                +3*(  -1.5172107368690897_rp)*s*s+4*(  -1.5172107369162715_rp)*s*t+3*(  -0.0000000000342917_rp)*t*t
     heslo(3, 3)=    0.2807969323084976_rp+2*(  -0.2807969322737502_rp)*s+2*(   1.2364138045616002_rp)*t&
                +3*(  -0.0000000000324771_rp)*s*s+4*(  -1.5172107369120971_rp)*s*t+3*(  -1.5172107368673551_rp)*t*t
     heslo(3, 4)=  -79.7694350723932075_rp+2*( 211.2134420756940472_rp)*s+2*( 119.6021122364136318_rp)*t&
                +3*(-136.7773403361930775_rp)*s*s+4*(-149.9433508352551598_rp)*s*t+3*( -55.8326771634506258_rp)*t*t
     heslo(3, 5)=   34.9456552233868933_rp+2*(-150.9456552308158734_rp)*s+2*( -35.1521840712055109_rp)*t&
                +3*( 128.0000000071673867_rp)*s*s+4*(  76.2065288559824694_rp)*s*t+3*(  12.2065288474843783_rp)*t*t
     heslo(3, 6)=   -6.9920947394621180_rp+2*(  24.8814210820214541_rp)*s+2*(   6.0474315694772400_rp)*t&
                +3*( -33.8893263425222955_rp)*s*s+4*(   4.3886701606570888_rp)*s*t+3*(  -4.3886701633013701_rp)*t*t
     heslo(3, 7)=    8.0632420921942867_rp+2*( -47.8959192493797872_rp)*s+2*(  -7.1185789229376155_rp)*t&
                +3*(  55.8326771571037881_rp)*s*s+4*(  17.5546806548235281_rp)*s*t+3*(   4.3886701639723640_rp)*t*t
     heslo(3, 8)=   -1.2608736244689567_rp+2*(   1.4674024674377790_rp)*s+2*(   1.4674024674318957_rp)*t&
                +3*( -12.2065288429870833_rp)*s*s+4*(  39.5869423141255865_rp)*s*t+3*( -12.2065288429873533_rp)*t*t
     heslo(3, 9)=    8.0632420922024721_rp+2*(  -7.1185789229073748_rp)*s+2*( -47.8959192494714898_rp)*t&
                +3*(   4.3886701639702750_rp)*s*s+4*(  17.5546806548536551_rp)*s*t+3*(  55.8326771571770450_rp)*t*t
     heslo(3,10)=   -6.9920947394698487_rp+2*(   6.0474315694737584_rp)*s+2*(  24.8814210820885933_rp)*t&
                +3*(  -4.3886701633092073_rp)*s*s+4*(   4.3886701606180765_rp)*s*t+3*( -33.8893263425786131_rp)*t*t
     heslo(3,11)=   34.9456552234114497_rp+2*( -35.1521840711213827_rp)*s+2*(-150.9456552311207815_rp)*t&
                +3*(  12.2065288474785518_rp)*s*s+4*(  76.2065288561027501_rp)*s*t+3*( 128.0000000074010131_rp)*t*t
     heslo(3,12)=  -79.7694350724123069_rp+2*( 119.6021122361757989_rp)*s+2*( 211.2134420760958164_rp)*t&
                +3*( -55.8326771633475119_rp)*s*s+4*(-149.9433508353474735_rp)*s*t+3*(-136.7773403364694786_rp)*t*t
     heslo(3,13)=   83.3411663078350102_rp+2*(-188.4829805611818756_rp)*s+2*(-188.4829805615527221_rp)*t&
                +3*( 105.1418142528370367_rp)*s*s+4*( 210.2836285085713826_rp)*s*t+3*( 105.1418142530505975_rp)*t*t
     heslo(3,14)=  -21.8006479476589448_rp+2*( 126.9424621956307533_rp)*s+2*(  21.8006479517496246_rp)*t&
                +3*(-105.1418142477331941_rp)*s*s+4*(-105.1418142527448367_rp)*s*t+3*(  -0.0000000037839527_rp)*t*t
     heslo(3,15)=  -21.8006479476762252_rp+2*(  21.8006479516582203_rp)*s+2*( 126.9424621958696662_rp)*t&
                +3*(  -0.0000000037693724_rp)*s*s+4*(-105.1418142528167436_rp)*s*t+3*(-105.1418142479110429_rp)*t*t

! * * * * * * * * * * * * * * * * * * * * * * * * * 
! *Valores calculados para cuadriláteros nnode=25 *
! * * * * * * * * * * * * * * * * * * * * * * * * *      
     else if (nnode==25) then
     s1 = s+1.0_rp
     s2 = s-1.0_rp
     s3 = s + 1.0_rp/2.0_rp
     s4 = s - 1.0_rp/2.0_rp
     Ns(1) = 2.0_rp*s*s3*s4*s2/3.0_rp     
     Ns(2) =-8.0_rp*s*s1*s4*s2/3.0_rp 
     Ns(3) = 4.0_rp*s1*s3*s4*s2 
     Ns(4) =-8.0_rp*s*s1*s3*s2/3.0_rp
     Ns(5) = 2.0_rp*s*s1*s3*s4/3.0_rp
     DNs(1) =2.0_rp*(s*s3*s4+s*s3*s2+s*s4*s2+s3*s4*s2)/3.0_rp
     DNs(2) =-8.0_rp*(s*s1*s4+s*s1*s2+s*s4*s2+s1*s4*s2)/3.0_rp
     DNs(3) = 4.0_rp*(s1*s3*s4+s1*s3*s2+s1*s4*s2+s3*s4*s2)
     DNs(4) =-8.0_rp*(s*s1*s3+s*s1*s2+s*s3*s2+s1*s3*s2)/3.0_rp
     DNs(5) = 2.0_rp*(s*s1*s3+s*s1*s4+s*s3*s4+s1*s3*s4)/3.0_rp
     D2Ns(1) = 4.0_rp*(s*s3+s*s4+s3*s4+s*s2+s3*s2+s4*s2)/3.0_rp
     D2Ns(2) =-16.0_rp*(s*s1+s*s4+s1*s4+s*s2+s1*s2+s4*s2)/3.0_rp
     D2Ns(3) = 8.0_rp*(s1*s3+s1*s4+s3*s4+s1*s2+s3*s2+s4*s2)
     D2Ns(4) =-16.0_rp*(s*s1+s*s3+s1*s3+s*s2+s1*s2+s3*s2)/3.0_rp
     D2Ns(5) = 4.0_rp*(s*s1+s*s3+s1*s3+s*s4+s1*s4+s3*s4)/3.0_rp
     t1 = t+1.0_rp   
     t2 = t-1-0_rp  
     t3 = t+1.0_rp/2.0_rp
     t4 = t-1.0_rp/2.0_rp
     Nt(1) = 2.0_rp*t*t3*t4*t2/3.0_rp     
     Nt(2) =-8.0_rp/3.0_rp*t*t1*t4*t2 
     Nt(3) = 4.0_rp*t1*t3*t4*t2 
     Nt(4) =-8.0_rp*t*t1*t3*t2/3.0_rp
     Nt(5) = 2.0_rp*t*t1*t3*t4/3.0_rp
     DNt(1) = 2.0_rp*(t*t3*t4+t*t3*t2+t*t4*t2+t3*t4*t2)/3.0_rp
     DNt(2) =-8.0_rp*(t*t1*t4+t*t1*t2+t*t4*t2+t1*t4*t2)/3.0_rp
     DNt(3) = 4.0_rp*(t1*t3*t4+t1*t3*t2+t1*t4*t2+t3*t4*t2)
     DNt(4) =-8.0_rp*(t*t1*t3+t*t1*t2+t*t3*t2+t1*t3*t2)/3.0_rp
     DNt(5) = 2.0_rp*(t*t1*t3+t*t1*t4+t*t3*t4+t1*t3*t4)/3.0_rp
     D2Nt(1) = 4.0_rp*(t*t3+t*t4+t3*t4+t*t2+t3*t2+t4*t2)/3.0_rp
     D2Nt(2) =-16.0_rp*(t*t1+t*t4+t1*t4+t*t2+t1*t2+t4*t2)/3.0_rp
     D2Nt(3) = 8.0_rp*(t1*t3+t1*t4+t3*t4+t1*t2+t3*t2+t4*t2)
     D2Nt(4) =-16.0_rp*(t*t1+t*t3+t1*t3+t*t2+t1*t2+t3*t2)/3.0_rp
     D2Nt(5) = 4.0_rp*(t*t1+t*t3+t1*t3+t*t4+t1*t4+t3*t4)/3.0_rp
     shape( 1) = Ns(1)*Nt(1)                !4     13    12    11     3
     shape( 2) = Ns(5)*Nt(1)                !
     shape( 3) = Ns(5)*Nt(5)                !
     shape( 4) = Ns(1)*Nt(5)                !14    23    22    21    10
     shape( 5) = Ns(2)*Nt(1)                !
     shape( 6) = Ns(3)*Nt(1)                !
     shape( 7) = Ns(4)*Nt(1)                !15    24    25    20     9  
     shape( 8) = Ns(5)*Nt(2)                ! 
     shape( 9) = Ns(5)*Nt(3)                !
     shape(10) = Ns(5)*Nt(4)                !16    17    18    19     8
     shape(11) = Ns(4)*Nt(5)                !
     shape(12) = Ns(3)*Nt(5)                !
     shape(13) = Ns(2)*Nt(5)                !1     5     6     7      2
     shape(14) = Ns(1)*Nt(4)
     shape(15) = Ns(1)*Nt(3)
     shape(16) = Ns(1)*Nt(2)
     shape(17) = Ns(2)*Nt(2)
     shape(18) = Ns(3)*Nt(2)
     shape(19) = Ns(4)*Nt(2)
     shape(20) = Ns(4)*Nt(3)
     shape(21) = Ns(4)*Nt(4)
     shape(22) = Ns(3)*Nt(4)
     shape(23) = Ns(2)*Nt(4)
     shape(24) = Ns(2)*Nt(3)
     shape(25) = Ns(3)*Nt(3)
     deriv(1, 1) = DNs(1)*Nt(1)
     deriv(1, 2) = DNs(5)*Nt(1)
     deriv(1, 3) = DNs(5)*Nt(5)
     deriv(1, 4) = DNs(1)*Nt(5)
     deriv(1, 5) = DNs(2)*Nt(1)
     deriv(1, 6) = DNs(3)*Nt(1)
     deriv(1, 7) = DNs(4)*Nt(1)
     deriv(1, 8) = DNs(5)*Nt(2)
     deriv(1, 9) = DNs(5)*Nt(3)
     deriv(1,10) = DNs(5)*Nt(4)
     deriv(1,11) = DNs(4)*Nt(5)
     deriv(1,12) = DNs(3)*Nt(5)
     deriv(1,13) = DNs(2)*Nt(5)
     deriv(1,14) = DNs(1)*Nt(4)
     deriv(1,15) = DNs(1)*Nt(3)
     deriv(1,16) = DNs(1)*Nt(2)
     deriv(1,17) = DNs(2)*Nt(2)
     deriv(1,18) = DNs(3)*Nt(2)
     deriv(1,19) = DNs(4)*Nt(2)
     deriv(1,20) = DNs(4)*Nt(3)
     deriv(1,21) = DNs(4)*Nt(4)
     deriv(1,22) = DNs(3)*Nt(4)
     deriv(1,23) = DNs(2)*Nt(4)
     deriv(1,24) = DNs(2)*Nt(3)
     deriv(1,25) = DNs(3)*Nt(3)
     deriv(2, 1) = Ns(1)*DNt(1)
     deriv(2, 2) = Ns(5)*DNt(1)
     deriv(2, 3) = Ns(5)*DNt(5)
     deriv(2, 4) = Ns(1)*DNt(5)
     deriv(2, 5) = Ns(2)*DNt(1)
     deriv(2, 6) = Ns(3)*DNt(1)
     deriv(2, 7) = Ns(4)*DNt(1)
     deriv(2, 8) = Ns(5)*DNt(2)
     deriv(2, 9) = Ns(5)*DNt(3)
     deriv(2,10) = Ns(5)*DNt(4)
     deriv(2,11) = Ns(4)*DNt(5)
     deriv(2,12) = Ns(3)*DNt(5)
     deriv(2,13) = Ns(2)*DNt(5)
     deriv(2,14) = Ns(1)*DNt(4)
     deriv(2,15) = Ns(1)*DNt(3)
     deriv(2,16) = Ns(1)*DNt(2)
     deriv(2,17) = Ns(2)*DNt(2)
     deriv(2,18) = Ns(3)*DNt(2)
     deriv(2,19) = Ns(4)*DNt(2)
     deriv(2,20) = Ns(4)*DNt(3)
     deriv(2,21) = Ns(4)*DNt(4)
     deriv(2,22) = Ns(3)*DNt(4)
     deriv(2,23) = Ns(2)*DNt(4)
     deriv(2,24) = Ns(2)*DNt(3)
     deriv(2,25) = Ns(3)*DNt(3)
     heslo(1, 1) = D2Ns(1)*Nt(1)
     heslo(1, 2) = D2Ns(5)*Nt(1)
     heslo(1, 3) = D2Ns(5)*Nt(5)
     heslo(1, 4) = D2Ns(1)*Nt(5)
     heslo(1, 5) = D2Ns(2)*Nt(1)
     heslo(1, 6) = D2Ns(3)*Nt(1)
     heslo(1, 7) = D2Ns(4)*Nt(1)
     heslo(1, 8) = D2Ns(5)*Nt(2)
     heslo(1, 9) = D2Ns(5)*Nt(3)
     heslo(1,10) = D2Ns(5)*Nt(4)
     heslo(1,11) = D2Ns(4)*Nt(5)
     heslo(1,12) = D2Ns(3)*Nt(5)
     heslo(1,13) = D2Ns(2)*Nt(5)
     heslo(1,14) = D2Ns(1)*Nt(4)
     heslo(1,15) = D2Ns(1)*Nt(3)
     heslo(1,16) = D2Ns(1)*Nt(2)
     heslo(1,17) = D2Ns(2)*Nt(2)
     heslo(1,18) = D2Ns(3)*Nt(2)
     heslo(1,19) = D2Ns(4)*Nt(2)
     heslo(1,20) = D2Ns(4)*Nt(3)
     heslo(1,21) = D2Ns(4)*Nt(4)
     heslo(1,22) = D2Ns(3)*Nt(4)
     heslo(1,23) = D2Ns(2)*Nt(4)
     heslo(1,24) = D2Ns(2)*Nt(3)
     heslo(1,25) = D2Ns(3)*Nt(3)
     heslo(2, 1) = Ns(1)*D2Nt(1)
     heslo(2, 2) = Ns(5)*D2Nt(1)
     heslo(2, 3) = Ns(5)*D2Nt(5)
     heslo(2, 4) = Ns(1)*D2Nt(5)
     heslo(2, 5) = Ns(2)*D2Nt(1)
     heslo(2, 6) = Ns(3)*D2Nt(1)
     heslo(2, 7) = Ns(4)*D2Nt(1)
     heslo(2, 8) = Ns(5)*D2Nt(2)
     heslo(2, 9) = Ns(5)*D2Nt(3)
     heslo(2,10) = Ns(5)*D2Nt(4)
     heslo(2,11) = Ns(4)*D2Nt(5)
     heslo(2,12) = Ns(3)*D2Nt(5)
     heslo(2,13) = Ns(2)*D2Nt(5)
     heslo(2,14) = Ns(1)*D2Nt(4)
     heslo(2,15) = Ns(1)*D2Nt(3)
     heslo(2,16) = Ns(1)*D2Nt(2)
     heslo(2,17) = Ns(2)*D2Nt(2)
     heslo(2,18) = Ns(3)*D2Nt(2)
     heslo(2,19) = Ns(4)*D2Nt(2)
     heslo(2,20) = Ns(4)*D2Nt(3)
     heslo(2,21) = Ns(4)*D2Nt(4)
     heslo(2,22) = Ns(3)*D2Nt(4)
     heslo(2,23) = Ns(2)*D2Nt(4)
     heslo(2,24) = Ns(2)*D2Nt(3)
     heslo(2,25) = Ns(3)*D2Nt(3)
     heslo(3, 1) = DNs(1)*DNt(1)
     heslo(3, 2) = DNs(5)*DNt(1)
     heslo(3, 3) = DNs(5)*DNt(5)
     heslo(3, 4) = DNs(1)*DNt(5)
     heslo(3, 5) = DNs(2)*DNt(1)
     heslo(3, 6) = DNs(3)*DNt(1)
     heslo(3, 7) = DNs(4)*DNt(1)
     heslo(3, 8) = DNs(5)*DNt(2)
     heslo(3, 9) = DNs(5)*DNt(3)
     heslo(3,10) = DNs(5)*DNt(4)
     heslo(3,11) = DNs(4)*DNt(5)
     heslo(3,12) = DNs(3)*DNt(5)
     heslo(3,13) = DNs(2)*DNt(5)
     heslo(3,14) = DNs(1)*DNt(4)
     heslo(3,15) = DNs(1)*DNt(3)
     heslo(3,16) = DNs(1)*DNt(2)
     heslo(3,17) = DNs(2)*DNt(2)
     heslo(3,18) = DNs(3)*DNt(2)
     heslo(3,19) = DNs(4)*DNt(2)
     heslo(3,20) = DNs(4)*DNt(3)
     heslo(3,21) = DNs(4)*DNt(4)
     heslo(3,22) = DNs(3)*DNt(4)
     heslo(3,23) = DNs(2)*DNt(4)
     heslo(3,24) = DNs(2)*DNt(3)
     heslo(3,25) = DNs(3)*DNt(3)

  end if
  
end subroutine shape2
